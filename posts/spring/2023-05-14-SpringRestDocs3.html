<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>Spring RestDocs 를 활용한 RestfulAPI 확인 - 리팩토링 | 앤디 블로그</title><meta name="description" content="Spring RestDocs 로 문서 남기기 - 3">
    <link rel="preload" href="/assets/style-DCLYmOir.css" as="style"><link rel="stylesheet" href="/assets/style-DCLYmOir.css">
    <link rel="modulepreload" href="/assets/app-DEgjeEtj.js"><link rel="modulepreload" href="/assets/2023-05-14-SpringRestDocs3.html-BnzC_dPM.js">
    <link rel="prefetch" href="/assets/index.html-DbzrxQiM.js" as="script"><link rel="prefetch" href="/assets/index.html-Dc3qlmkw.js" as="script"><link rel="prefetch" href="/assets/index.html-CVTfm2OW.js" as="script"><link rel="prefetch" href="/assets/index.html-CA3yE2xr.js" as="script"><link rel="prefetch" href="/assets/index.html-W3EAocqY.js" as="script"><link rel="prefetch" href="/assets/2023-11-18-system.html-B8CfuFwC.js" as="script"><link rel="prefetch" href="/assets/2024-02-26-network.html-Et6cDWXf.js" as="script"><link rel="prefetch" href="/assets/2024-04-24-cloudfinops.html-vS3fFSTA.js" as="script"><link rel="prefetch" href="/assets/2024-10-10-tensorflow.html-kuVROqh5.js" as="script"><link rel="prefetch" href="/assets/2025-02-08-whatiswork.html-DZO7WpbZ.js" as="script"><link rel="prefetch" href="/assets/2025-02-11-kafka.html-CjRZUhO-.js" as="script"><link rel="prefetch" href="/assets/2025-02-16-object.html-CQgtoJ9G.js" as="script"><link rel="prefetch" href="/assets/2025-03-03-skilloflove.html-DH3sWGja.js" as="script"><link rel="prefetch" href="/assets/2025-03-08-terraform.html-DPHDIclu.js" as="script"><link rel="prefetch" href="/assets/2025-03-09-software.html-nq02K1hK.js" as="script"><link rel="prefetch" href="/assets/2025-03-23-chosun.html-CwgYoP1I.js" as="script"><link rel="prefetch" href="/assets/2025-08-31-unittest.html-CvptCZEM.js" as="script"><link rel="prefetch" href="/assets/2026-01-05-c.html-Ce8RTChm.js" as="script"><link rel="prefetch" href="/assets/2025-02-07-ze.html-B5hqbeot.js" as="script"><link rel="prefetch" href="/assets/2025-02-10-firstlog.html-CZZpQ4jl.js" as="script"><link rel="prefetch" href="/assets/2025-02-14-log.html-DtqCW8w7.js" as="script"><link rel="prefetch" href="/assets/2025-02-23-anna.html-zAv_Ye9o.js" as="script"><link rel="prefetch" href="/assets/2025-03-02-bystander.html-CuJUThZh.js" as="script"><link rel="prefetch" href="/assets/2025-04-08-k8s.html-BE-e2ZU7.js" as="script"><link rel="prefetch" href="/assets/2025-04-20-log.html-DmNshMW0.js" as="script"><link rel="prefetch" href="/assets/2025-08-18-coworker.html-Dw9zdV86.js" as="script"><link rel="prefetch" href="/assets/2026-01-02-design.html-Bp0FitWH.js" as="script"><link rel="prefetch" href="/assets/2025-02-25-aws.html-BhfL81bu.js" as="script"><link rel="prefetch" href="/assets/2025-03-13-aws.html-mQgtmuUp.js" as="script"><link rel="prefetch" href="/assets/2025-03-20-aws.html-CNDVRtNO.js" as="script"><link rel="prefetch" href="/assets/index.html-BSoYPEDl.js" as="script"><link rel="prefetch" href="/assets/2025-08-26-culture1.html-ClChYTB-.js" as="script"><link rel="prefetch" href="/assets/2025-08-27-culturetest.html-Ijds2JKj.js" as="script"><link rel="prefetch" href="/assets/index.html-Bq65JWk9.js" as="script"><link rel="prefetch" href="/assets/2025-04-20-leteraljoin.html-yAfvqKQV.js" as="script"><link rel="prefetch" href="/assets/2025-09-30-likesearch.html-BBel3D0n.js" as="script"><link rel="prefetch" href="/assets/index.html-DO2LS5js.js" as="script"><link rel="prefetch" href="/assets/2023-10-20-cpucredit.html-CmYLGE7g.js" as="script"><link rel="prefetch" href="/assets/2023-12-15-awslambda.html-BVO-gGeL.js" as="script"><link rel="prefetch" href="/assets/2024-05-23-goodlog.html-D7sR2-ah.js" as="script"><link rel="prefetch" href="/assets/2024-10-28-sg.html-C2431aq8.js" as="script"><link rel="prefetch" href="/assets/2025-01-24-eksdnsresolve.html-Ur765TP9.js" as="script"><link rel="prefetch" href="/assets/2025-03-15-filesystem.html-C-sWcU0M.js" as="script"><link rel="prefetch" href="/assets/2025-05-04-awsregion.html-Bn5_36iq.js" as="script"><link rel="prefetch" href="/assets/2025-09-03-kuberesource.html-t2Hgkm-j.js" as="script"><link rel="prefetch" href="/assets/2025-09-05-podeviction.html-RLj9t-us.js" as="script"><link rel="prefetch" href="/assets/2025-09-15-autoscaling.html-DiZ-qyoh.js" as="script"><link rel="prefetch" href="/assets/2025-09-22-rollingupdate.html-Bo4vV8Lu.js" as="script"><link rel="prefetch" href="/assets/2025-09-29-loadtest.html-xOSVORFv.js" as="script"><link rel="prefetch" href="/assets/2025-11-17-kms.html-D-DBfjan.js" as="script"><link rel="prefetch" href="/assets/index.html-1moQTcD4.js" as="script"><link rel="prefetch" href="/assets/2025-09-17-hashmap.html-CUnf2xSY.js" as="script"><link rel="prefetch" href="/assets/2025-09-23-referencevalue.html-Bc_ykcND.js" as="script"><link rel="prefetch" href="/assets/2025-10-04-stringimmutable.html-B6fb2d0P.js" as="script"><link rel="prefetch" href="/assets/2025-10-05-immutableclass.html-D54q4j2h.js" as="script"><link rel="prefetch" href="/assets/2025-10-05-singleton.html-DY7YM4Jk.js" as="script"><link rel="prefetch" href="/assets/index.html-vCmq_s4T.js" as="script"><link rel="prefetch" href="/assets/2025-01-18-kafkadocker.html-D2MIRII5.js" as="script"><link rel="prefetch" href="/assets/2025-10-25-kafkaaggregate.html-DNACid9S.js" as="script"><link rel="prefetch" href="/assets/2025-12-09-kafkadesignpattern.html-DKeOE-YY.js" as="script"><link rel="prefetch" href="/assets/index.html-C9WAYFNk.js" as="script"><link rel="prefetch" href="/assets/2023-04-12-validation.html-Cnden9qn.js" as="script"><link rel="prefetch" href="/assets/2023-04-18-rtr.html-Cj8qPYUy.js" as="script"><link rel="prefetch" href="/assets/2023-04-25-mdc.html-CuZhmsyQ.js" as="script"><link rel="prefetch" href="/assets/2023-05-10-SpringRestDocs1.html-DStaYKdA.js" as="script"><link rel="prefetch" href="/assets/2023-05-13-SpringRestDocs2.html-DYxiMbkU.js" as="script"><link rel="prefetch" href="/assets/2025-02-13-security.html-CMS1-Pcv.js" as="script"><link rel="prefetch" href="/assets/2025-06-25-alarm.html-GBsXUqJV.js" as="script"><link rel="prefetch" href="/assets/2025-07-20-ssewebsocket.html-DPz7LiKf.js" as="script"><link rel="prefetch" href="/assets/2025-08-05-test1.html-CZZL6Gyy.js" as="script"><link rel="prefetch" href="/assets/2025-08-20-test2.html-DfYg0OEZ.js" as="script"><link rel="prefetch" href="/assets/2025-08-28-jsonproperty.html-CCYAj2fD.js" as="script"><link rel="prefetch" href="/assets/2025-09-08-sonarqube.html-DdhG8osk.js" as="script"><link rel="prefetch" href="/assets/2025-10-22-eventhandler.html-BEJ4UT9z.js" as="script"><link rel="prefetch" href="/assets/index.html-D7Pw6Jdw.js" as="script"><link rel="prefetch" href="/assets/2025-01-01-list.html-DvO_wrj9.js" as="script"><link rel="prefetch" href="/assets/2025-06-27-iot.html-ExRpqKtX.js" as="script"><link rel="prefetch" href="/assets/2025-07-20-ssewebsocket.html-DNfMaSlb.js" as="script"><link rel="prefetch" href="/assets/2025-08-13-mqtt.html-Cf7ZL14Y.js" as="script"><link rel="prefetch" href="/assets/2025-08-29-oidc.html-DrjojR2X.js" as="script"><link rel="prefetch" href="/assets/2025-09-04-smtp.html-De4LWJ3G.js" as="script"><link rel="prefetch" href="/assets/2025-09-16-cscd.html-CrX6_i01.js" as="script"><link rel="prefetch" href="/assets/2025-09-18-flame.html-U-h26rTd.js" as="script"><link rel="prefetch" href="/assets/2025-10-01-keycloak.html-DEap1BM_.js" as="script"><link rel="prefetch" href="/assets/index.html-Datpow0a.js" as="script"><link rel="prefetch" href="/assets/404.html-DKwwjyy-.js" as="script"><link rel="prefetch" href="/assets/html2pdf-Du1G4kJv.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-D37ONdPH.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="vp-site-name" aria-hidden="true">앤디 블로그</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="글"><span class="title">글</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="글"><span class="title">글</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/" aria-label="모두"><!--[--><!--[--><!--]--><!--]-->모두<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/culture/" aria-label="개발 문화"><!--[--><!--[--><!--]--><!--]-->개발 문화<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/tech/" aria-label="기술"><!--[--><!--[--><!--]--><!--]-->기술<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/java/" aria-label="자바"><!--[--><!--[--><!--]--><!--]-->자바<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/spring/" aria-label="스프링"><!--[--><!--[--><!--]--><!--]-->스프링<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/infra/" aria-label="인프라"><!--[--><!--[--><!--]--><!--]-->인프라<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/kafka/" aria-label="카프카"><!--[--><!--[--><!--]--><!--]-->카프카<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/database/" aria-label="데이터베이스"><!--[--><!--[--><!--]--><!--]-->데이터베이스<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/conference/" aria-label="컨퍼런스"><!--[--><!--[--><!--]--><!--]-->컨퍼런스<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/books/" aria-label="책"><!--[--><!--[--><!--]--><!--]-->책<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/logs/" aria-label="짧은 글"><!--[--><!--[--><!--]--><!--]-->짧은 글<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/resume/" aria-label="이력서"><!--[--><!--[--><!--]--><!--]-->이력서<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="글"><span class="title">글</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="글"><span class="title">글</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/" aria-label="모두"><!--[--><!--[--><!--]--><!--]-->모두<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/culture/" aria-label="개발 문화"><!--[--><!--[--><!--]--><!--]-->개발 문화<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/tech/" aria-label="기술"><!--[--><!--[--><!--]--><!--]-->기술<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/java/" aria-label="자바"><!--[--><!--[--><!--]--><!--]-->자바<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/spring/" aria-label="스프링"><!--[--><!--[--><!--]--><!--]-->스프링<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/infra/" aria-label="인프라"><!--[--><!--[--><!--]--><!--]-->인프라<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/kafka/" aria-label="카프카"><!--[--><!--[--><!--]--><!--]-->카프카<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/database/" aria-label="데이터베이스"><!--[--><!--[--><!--]--><!--]-->데이터베이스<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/conference/" aria-label="컨퍼런스"><!--[--><!--[--><!--]--><!--]-->컨퍼런스<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/books/" aria-label="책"><!--[--><!--[--><!--]--><!--]-->책<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/logs/" aria-label="짧은 글"><!--[--><!--[--><!--]--><!--]-->짧은 글<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/resume/" aria-label="이력서"><!--[--><!--[--><!--]--><!--]-->이력서<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Spring RestDocs 를 활용한 RestfulAPI 확인 - 리팩토링 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#refactoring-beforeeach" aria-label="Refactoring - @BeforeEach"><!--[--><!--[--><!--]--><!--]-->Refactoring - @BeforeEach<!--[--><!--[--><!--]--><!--]--></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#restdocstestsupport" aria-label="RestDocsTestSupport"><!--[--><!--[--><!--]--><!--]-->RestDocsTestSupport<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#test-코드-수정" aria-label="Test 코드 수정"><!--[--><!--[--><!--]--><!--]-->Test 코드 수정<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#refactoring-test" aria-label="Refactoring - @Test"><!--[--><!--[--><!--]--><!--]-->Refactoring - @Test<!--[--><!--[--><!--]--><!--]--></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#document-공통-제목-설정" aria-label="document 공통 제목 설정"><!--[--><!--[--><!--]--><!--]-->document 공통 제목 설정<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#제약조건-설정" aria-label="제약조건 설정"><!--[--><!--[--><!--]--><!--]-->제약조건 설정<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#popup-링크-동적으로-만들기" aria-label="popup 링크 동적으로 만들기"><!--[--><!--[--><!--]--><!--]-->popup 링크 동적으로 만들기<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#공통-코드-문서화" aria-label="공통 코드 문서화"><!--[--><!--[--><!--]--><!--]-->공통 코드 문서화<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#http-status-code-host-환경-문서화" aria-label="HTTP status code, host 환경 문서화"><!--[--><!--[--><!--]--><!--]-->HTTP status code, host 환경 문서화<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#마치며" aria-label="마치며"><!--[--><!--[--><!--]--><!--]-->마치며<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#ref" aria-label="Ref."><!--[--><!--[--><!--]--><!--]-->Ref.<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><header class="page-header" data-v-84f05ea1><h1 class="title" data-v-84f05ea1>Spring RestDocs 를 활용한 RestfulAPI 확인 - 리팩토링</h1><div class="meta" data-v-84f05ea1><time data-v-84f05ea1>2023년 5월 14일</time></div></header><nav class="table-of-contents"><ul><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#refactoring-beforeeach" class="router-link-active router-link-exact-active">Refactoring - @BeforeEach</a><ul><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#restdocstestsupport" class="router-link-active router-link-exact-active">RestDocsTestSupport</a></li><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#test-코드-수정" class="router-link-active router-link-exact-active">Test 코드 수정</a></li></ul></li><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#refactoring-test" class="router-link-active router-link-exact-active">Refactoring - @Test</a><ul><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#document-공통-제목-설정" class="router-link-active router-link-exact-active">document 공통 제목 설정</a></li><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#제약조건-설정" class="router-link-active router-link-exact-active">제약조건 설정</a></li></ul></li><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#popup-링크-동적으로-만들기" class="router-link-active router-link-exact-active">popup 링크 동적으로 만들기</a></li><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#공통-코드-문서화" class="router-link-active router-link-exact-active">공통 코드 문서화</a></li><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#http-status-code-host-환경-문서화" class="router-link-active router-link-exact-active">HTTP status code, host 환경 문서화</a></li><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#마치며" class="router-link-active router-link-exact-active">마치며</a></li><li><a aria-current="page" href="/posts/spring/2023-05-14-SpringRestDocs3.html#ref" class="router-link-active router-link-exact-active">Ref.</a></li></ul></nav><h1 id="refactoring-beforeeach" tabindex="-1"><a class="header-anchor" href="#refactoring-beforeeach"><span>Refactoring - @BeforeEach</span></a></h1><pre><code>모든 Test 에 공통적으로 적용되는 게 있습니다. 바로 아래의 @BeforeEach 코드입니다.
</code></pre><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">private</span> <span class="token class-name">MockMvc</span> mockMvc<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation punctuation">@BeforeEach</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token class-name">WebApplicationContext</span> webApplicationContext<span class="token punctuation">,</span></span>
<span class="line">                  <span class="token class-name">RestDocumentationContextProvider</span> restDocumentation<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>mockMvc <span class="token operator">=</span> <span class="token class-name">MockMvcBuilders</span><span class="token punctuation">.</span><span class="token function">webAppContextSetup</span><span class="token punctuation">(</span>webApplicationContext<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token function">documentationConfiguration</span><span class="token punctuation">(</span>restDocumentation<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">operationPreprocessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">withResponseDefaults</span><span class="token punctuation">(</span><span class="token function">prettyPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                  	<span class="token punctuation">.</span><span class="token function">withRequestDefaults</span><span class="token punctuation">(</span><span class="token function">prettyPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이 코드와 mockMvc, 그리고 각종 어노테이션까지 반복되는 설정이 중복되기 때문에 해당 설정들을 모두 RestDocsTestSupport 에 넣어주겠습니다.</p><h2 id="restdocstestsupport" tabindex="-1"><a class="header-anchor" href="#restdocstestsupport"><span>RestDocsTestSupport</span></a></h2><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Disabled</span></span>
<span class="line"><span class="token annotation punctuation">@AutoConfigureMockMvc</span></span>
<span class="line"><span class="token annotation punctuation">@ExtendWith</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">RestDocumentationExtension</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">SpringExtension</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token annotation punctuation">@SpringBootTest</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestDocsTestSupport</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Autowired</span> <span class="token keyword">protected</span> <span class="token class-name">ObjectMapper</span> objectMapper<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Autowired</span></span>
<span class="line">    <span class="token keyword">protected</span> <span class="token class-name">MockMvc</span> mockMvc<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@BeforeEach</span></span>
<span class="line">    <span class="token keyword">void</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">WebApplicationContext</span> webApplicationContext<span class="token punctuation">,</span></span>
<span class="line">               <span class="token keyword">final</span> <span class="token class-name">RestDocumentationContextProvider</span> restDocumentation<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>mockMvc <span class="token operator">=</span> <span class="token class-name">MockMvcBuilders</span><span class="token punctuation">.</span><span class="token function">webAppContextSetup</span><span class="token punctuation">(</span>webApplicationContext<span class="token punctuation">)</span></span>
<span class="line">               <span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token class-name">MockMvcRestDocumentation</span><span class="token punctuation">.</span><span class="token function">documentationConfiguration</span><span class="token punctuation">(</span>restDocumentation<span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">operationPreprocessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">withResponseDefaults</span><span class="token punctuation">(</span><span class="token function">prettyPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">withRequestDefaults</span><span class="token punctuation">(</span><span class="token function">prettyPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">addFilters</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CharacterEncodingFilter</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Test 를 직접할 코드가 아니기 때문에 @Disabled 를 넣었습니다. @AutoConfigureMockMVC 는 MockMvc 를 주입받기 위해 넣었습니다. 나머지 2개는 원래 Test 코드에 있던 걸 그대로 넣었습니다.</li><li>ObjectMapper 와 MockMvc 를 주입받아서 사용합니다.</li><li>@BeforeEach 에서는 원래 test 코드에 있던 설정을 그대로 넣었습니다. 그리고 한글깨짐을 방지하기 위해 UTF-8 설정도 추가로 넣었습니다.</li></ul><h2 id="test-코드-수정" tabindex="-1"><a class="header-anchor" href="#test-코드-수정"><span>Test 코드 수정</span></a></h2><p>이제 Test 코드를 수정해보겠습니다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token comment">/*@ExtendWith({RestDocumentationExtension.class, SpringExtension.class})</span>
<span class="line">@SpringBootTest*/</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">MemberControllerTest</span> <span class="token keyword">extends</span> <span class="token class-name">RestDocsTestSupport</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">/*private MockMvc mockMvc;</span>
<span class="line"></span>
<span class="line">    @BeforeEach</span>
<span class="line">    public void setUp(WebApplicationContext webApplicationContext,</span>
<span class="line">                      RestDocumentationContextProvider restDocumentation) {</span>
<span class="line">        this.mockMvc = MockMvcBuilders.webAppContextSetup(webApplicationContext)</span>
<span class="line">                .apply(documentationConfiguration(restDocumentation)</span>
<span class="line">                        .operationPreprocessors()</span>
<span class="line">                        .withResponseDefaults(prettyPrint())</span>
<span class="line">                        .withRequestDefaults(prettyPrint()))</span>
<span class="line">                .build();</span>
<span class="line">    }*/</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@MockBean</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">MemberService</span> memberService<span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>RestDocsTestSupport 에서 설정한 내용은 모두 상속받는다고 생각하면 되기 때문에, 모두 삭제해줍니다. 다른 Test 들도 똑같이 삭제해줍시다.</p><h1 id="refactoring-test" tabindex="-1"><a class="header-anchor" href="#refactoring-test"><span>Refactoring - @Test</span></a></h1><pre><code>이제 @Test 코드 안에 어떤 코드가 중복되는지 확인해보겠습니다.
</code></pre><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">final</span> <span class="token class-name">PostResponse</span> postResponse <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PostResponse</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">when</span><span class="token punctuation">(</span>postService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>postResponse<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>mockMvc<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/posts&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;title\&quot;: \&quot;title\&quot;, \n\&quot;content\&quot;: \&quot;content\&quot;}&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isCreated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">andDo</span><span class="token punctuation">(</span><span class="token function">document</span><span class="token punctuation">(</span><span class="token string">&quot;post-create&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token function">requestFields</span><span class="token punctuation">(</span></span>
<span class="line">                            <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Post 제목&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Attributes<span class="token punctuation">.</span>Attribute</span><span class="token punctuation">(</span><span class="token string">&quot;constraints&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;길이 100 이하&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                            <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Post 내용&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>document 제목이 반복됩니다. [문서 내용]-[행위] 로 반복되는 패턴입니다.</li><li><strong>제약조건</strong> 또한 반복됩니다. 제약 조건은 field 마다 다르지만, Entity 에서 어노테이션으로 선언된 제약조건을 그대로 가져와서 사용할 수 있을 것 같습니다.</li></ol><h2 id="document-공통-제목-설정" tabindex="-1"><a class="header-anchor" href="#document-공통-제목-설정"><span>document 공통 제목 설정</span></a></h2><pre><code>먼저 document 제목부터 설정하겠습니다. RestDocsTestSupport 의 @BeforeEach 설정에 아래와 같이 추가하고, 설정을 사용할 수 있도록 `RestDocumentationResultHandler` 을 주입해줍니다.
</code></pre><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestDocsTestSupport</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">protected</span> <span class="token class-name">RestDocumentationResultHandler</span> documentHandler<span class="token punctuation">;</span><span class="token comment">//RestDocumentationResultHandler 선언</span></span>
<span class="line">    </span>
<span class="line">    <span class="token annotation punctuation">@Autowired</span> <span class="token keyword">protected</span> <span class="token class-name">ObjectMapper</span> objectMapper<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Autowired</span></span>
<span class="line">    <span class="token keyword">protected</span> <span class="token class-name">MockMvc</span> mockMvc<span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">    <span class="token annotation punctuation">@BeforeEach</span></span>
<span class="line">    <span class="token keyword">void</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">WebApplicationContext</span> webApplicationContext<span class="token punctuation">,</span></span>
<span class="line">               <span class="token keyword">final</span> <span class="token class-name">RestDocumentationContextProvider</span> restDocumentation<span class="token punctuation">,</span></span>
<span class="line">               <span class="token class-name">TestInfo</span> testInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">String</span> className <span class="token operator">=</span> testInfo<span class="token punctuation">.</span><span class="token function">getTestClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;ControllerTest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">String</span> methodName <span class="token operator">=</span> testInfo<span class="token punctuation">.</span><span class="token function">getTestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        documentHandler <span class="token operator">=</span> <span class="token function">document</span><span class="token punctuation">(</span></span>
<span class="line">                className <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> methodName</span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>mockMvc <span class="token operator">=</span> <span class="token class-name">MockMvcBuilders</span><span class="token punctuation">.</span><span class="token function">webAppContextSetup</span><span class="token punctuation">(</span>webApplicationContext<span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token class-name">MockMvcRestDocumentation</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">documentationConfiguration</span><span class="token punctuation">(</span>restDocumentation<span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">operationPreprocessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">withResponseDefaults</span><span class="token punctuation">(</span><span class="token function">prettyPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">withRequestDefaults</span><span class="token punctuation">(</span><span class="token function">prettyPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">alwaysDo</span><span class="token punctuation">(</span>documentHandler<span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">addFilters</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CharacterEncodingFilter</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>먼저 test 클래스에서 정보를 받아와야 하기 때문에 파라미터값으로 testInfo 를 받습니다.</p></li><li><p>&#39;post-create&#39; 에서 post 는 class 이름인 PostControllerTest 에서 ControllerTest 를 뺀 것입니다. 따라서 replace 를 이용하여 className 을 위와 같이 설정해줍니다.</p></li><li><p>리팩토링 후 directory 구조는 &#39;post/{test method name}&#39; 과 같이 만들 겁니다. 따라서 methodName 은 그대로 받습니다.</p></li><li><p><code>RestDocumentationResultHandler</code> 로 document 이름을 <code>className / methodName</code> 으로 설정합니다. 이렇게 설정하면 className/methodName 디렉토리 구조가 형성됩니다.</p></li><li><p><code>.alwaysDo(documentHandler)</code> 를 통해 만들어둔 <code>RestDocumentationResultHandler</code> 를 적용시킵니다.</p><p>이제 test 코드안에서 불필요한 부분을 삭제하겠습니다.</p></li></ul><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line">    <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">final</span> <span class="token class-name">PostResponse</span> postResponse <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PostResponse</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">when</span><span class="token punctuation">(</span>postService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>postResponse<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>mockMvc<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/posts&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;title\&quot;: \&quot;title\&quot;, \n\&quot;content\&quot;: \&quot;content\&quot;}&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isCreated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">andDo</span><span class="token punctuation">(</span>documentHandler<span class="token punctuation">.</span><span class="token function">document</span><span class="token punctuation">(</span></span>
<span class="line">                        <span class="token function">requestFields</span><span class="token punctuation">(</span></span>
<span class="line">                                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Post 제목&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Attributes<span class="token punctuation">.</span>Attribute</span><span class="token punctuation">(</span><span class="token string">&quot;constraints&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;길이 100 이하&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Post 내용&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>.andDo 에서 부모클래스에서 주입받은 documentHandler 를 사용합니다.</p><h2 id="제약조건-설정" tabindex="-1"><a class="header-anchor" href="#제약조건-설정"><span>제약조건 설정</span></a></h2><pre><code>이제 제약조건 코드를 줄여보겠습니다. 지금은 이렇게 되어있습니다.
</code></pre><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">final</span> <span class="token class-name">PostResponse</span> postResponse <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PostResponse</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">when</span><span class="token punctuation">(</span>postService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>postResponse<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>mockMvc<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/posts&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;title\&quot;: \&quot;title\&quot;, \n\&quot;content\&quot;: \&quot;content\&quot;}&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isCreated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">andDo</span><span class="token punctuation">(</span>documentHandler<span class="token punctuation">.</span><span class="token function">document</span><span class="token punctuation">(</span></span>
<span class="line">                    <span class="token function">requestFields</span><span class="token punctuation">(</span></span>
<span class="line">                            <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Post 제목&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Attributes<span class="token punctuation">.</span>Attribute</span><span class="token punctuation">(</span><span class="token string">&quot;constraints&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;길이 100 이하&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                            <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Post 내용&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이 코드에서 <code>.attributes(new Attributes.Attribute(&quot;constraints&quot;,&quot;길이 100 이하&quot;))</code> 부분은 Dto 의 제약조건으로, 해당 클래스에서 가져올 수 있습니다. (entity 에 제약조건을 설정해도 됩니다.)</p><p>먼저 제약조건을 설정하는 ConstraintFields 를 선언해줍니다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConstraintFields</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">//사용할 ConstraintDescriptions 선언</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ConstraintDescriptions</span> constraintDescriptions<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">//dto 클래스 주입</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">ConstraintFields</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>constraintDescriptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConstraintDescriptions</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">//fieldWithPath(path) 에 attributes 를 붙임</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">FieldDescriptor</span> <span class="token function">withPath</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token function">fieldWithPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span></span>
<span class="line">                <span class="token class-name">Attributes</span><span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token string">&quot;constraints&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span></span>
<span class="line">                        <span class="token keyword">this</span><span class="token punctuation">.</span>constraintDescriptions<span class="token punctuation">.</span><span class="token function">descriptionsForProperty</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>description <span class="token operator">-&gt;</span> <span class="token string">&quot;- &quot;</span> <span class="token operator">+</span> description<span class="token punctuation">)</span></span>
<span class="line">                                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>ConstraintDescriptions.descriptionsForProperty(field 명).joining(&quot;\n&quot;)</code> 을 통해 제약 조건을 가져올 수 있습니다. 제약조건은 필드마다 1개 이상이 될 수 있으니 모두 가져와야 합니다.</li></ul><p>이제 MemberControllerTest 을 다음과 같이 변경합니다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">PostControllerTest</span> <span class="token keyword">extends</span> <span class="token class-name">RestDocsTestSupport</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@MockBean</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">PostService</span> postService<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name">ConstraintFields</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PostRequest</span><span class="token punctuation">&gt;</span></span> fields <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConstraintFields</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">PostRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Test</span></span>
<span class="line">    <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">final</span> <span class="token class-name">PostResponse</span> postResponse <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PostResponse</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">when</span><span class="token punctuation">(</span>postService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>postResponse<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>mockMvc<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/posts&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;title\&quot;: \&quot;title\&quot;, \n\&quot;content\&quot;: \&quot;content\&quot;}&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isCreated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">andDo</span><span class="token punctuation">(</span>documentHandler<span class="token punctuation">.</span><span class="token function">document</span><span class="token punctuation">(</span></span>
<span class="line">                        <span class="token function">requestFields</span><span class="token punctuation">(</span></span>
<span class="line">                            <span class="token comment">//해당 부분 변경</span></span>
<span class="line">                                fields<span class="token punctuation">.</span><span class="token function">withPath</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Post 제목&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Post 내용&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>ConstraintFields&lt;PostRequest&gt; fields</code> 를 선언하고, 제약조건이 필요한 곳에 사용해줍니다. 따지기 귀찮으면 다 붙여줘도 됩니다.</li></ul><p>제약조건이 아래와 같이 변경되었습니다. <img src="/images/2023-05-14-SpringRestDocs3/image-20230514161531214.png" alt="image-20230514161531214"></p><h1 id="popup-링크-동적으로-만들기" tabindex="-1"><a class="header-anchor" href="#popup-링크-동적으로-만들기"><span>popup 링크 동적으로 만들기</span></a></h1><pre><code>먼저 signUp 테스트 메서드를 보겠습니다.
</code></pre><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line">    <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">final</span> <span class="token class-name">MemberResponse</span> memberResponse <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MemberResponse</span><span class="token punctuation">(</span><span class="token string">&quot;memberName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Authority</span><span class="token punctuation">.</span><span class="token constant">USER</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">when</span><span class="token punctuation">(</span>memberService<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>memberResponse<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>mockMvc<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/members/login&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;memberName\&quot;: \&quot;memberName\&quot;, \&quot;password\&quot;: \&quot;password\&quot;}&quot;</span><span class="token punctuation">)</span> </span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isOk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">andDo</span><span class="token punctuation">(</span>documentHandler<span class="token punctuation">.</span><span class="token function">document</span><span class="token punctuation">(</span></span>
<span class="line">                        <span class="token function">requestFields</span><span class="token punctuation">(</span></span>
<span class="line">                                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;memberName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Member memberName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Member password&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                        <span class="token function">responseFields</span><span class="token punctuation">(</span></span>
<span class="line">                                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;memberName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Member memberName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Member password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Member email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;authority&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;link:common/authority.html[Enum,role=\&quot;popup\&quot;]&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>여기서 <code>.description(&quot;link:common/authority.html[Enum,role=\&quot;popup\&quot;]&quot;)</code> 부분은 링크가 틀리거나 popup 이 오타가 나면 제대로 작동하지 않게 됩니다. 따라서 <code>&quot;&quot;</code> 와 같이 문자로 처리하기보다는 메서드를 만들어서 관리하겠습니다.</p><p><strong>RestDocsTestSupport</strong></p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestDocsTestSupport</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">generateLinkCode</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;link:common/%s.html[Enum,role=\&quot;popup\&quot;]&quot;</span><span class="token punctuation">,</span> clazz<span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Test 가 모두 상속받는 <code>RestDocsTestSupport</code> 클래에서 메서드를 만들어주도록 하겠습니다. <code>generateLinkCode</code> 는 링크를 작성하는 코드입니다. class 를 받으면 해당 클래스의 이름대로 링크를 만듭니다.</p><p><strong>login()</strong></p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token function">responseFields</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;memberName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Member memberName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Member password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Member email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;authority&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token function">generateLinkCode</span><span class="token punctuation">(</span><span class="token class-name">Authority</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>로그인 메서드는 다음과 같이 바뀌면 됩니다.</p><h1 id="공통-코드-문서화" tabindex="-1"><a class="header-anchor" href="#공통-코드-문서화"><span>공통 코드 문서화</span></a></h1><p><strong>CommonDocController</strong></p><pre><code>HTTP Error Response, HTTP status codes, Host 환경 등을 문서화해보겠습니다. 에러 관련 문서화를 위해 테스트 컨트롤러에 다음과 같이 추가합니다.
</code></pre><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@RestController</span></span>
<span class="line"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/test&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonDocController</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/error&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">errorSample</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token annotation punctuation">@Valid</span> <span class="token class-name">SampleRequest</span> dto<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Getter</span></span>
<span class="line">    <span class="token annotation punctuation">@Setter</span></span>
<span class="line">    <span class="token annotation punctuation">@AllArgsConstructor</span></span>
<span class="line">    <span class="token annotation punctuation">@NoArgsConstructor</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SampleRequest</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">        <span class="token annotation punctuation">@NotEmpty</span></span>
<span class="line">        <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token annotation punctuation">@Email</span></span>
<span class="line">        <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line">        </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>GlobalExceptionHandler</strong></p><p>그리고 ExceptionHandler 를 위해 <strong>Main</strong> 위치에 <code>GlobalExceptionHandler</code> 를 만듭니다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@ControllerAdvice</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionHandler</span> <span class="token punctuation">{</span></span>
<span class="line">    </span>
<span class="line"><span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleMethodArgumentNotValidException</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> errorResponse <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    errorResponse<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Error occurred&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    errorResponse<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ERROR_CODE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    errorResponse<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;errors&quot;</span><span class="token punctuation">,</span> ex<span class="token punctuation">.</span><span class="token function">getFieldErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>fieldError <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> errorDetail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        errorDetail<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span> fieldError<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        errorDetail<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span> fieldError<span class="token punctuation">.</span><span class="token function">getRejectedValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        errorDetail<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;reason&quot;</span><span class="token punctuation">,</span> fieldError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> errorDetail<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">badRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span>errorResponse<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>MethodArgumentNotValidException을 받으면 message, code, errors[], error.field, error.value, error.reason 을 리턴합니다.</li></ul><p><strong>exception-response-fields.snippet</strong></p><p>Exception 에는 제약 조건, optional 이 필요없으므로 <code>exception-response-fields.snippet</code> 을 새로 만듭니다. 위치는 test.resources.org.springframework.restdocs.templates 입니다.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">|===</span>
<span class="line">|Path|Type|Description</span>
<span class="line"></span>
<span class="line">{{#fields}}</span>
<span class="line">|{{#tableCellContent}}`+{{path}}+`{{/tableCellContent}}</span>
<span class="line">|{{#tableCellContent}}`+{{type}}+`{{/tableCellContent}}</span>
<span class="line">|{{#tableCellContent}}{{description}}{{/tableCellContent}}</span>
<span class="line">{{/fields}}</span>
<span class="line">|===</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>CustomResponseFieldsSnippet</strong></p><pre><code>해당 클래스의 생성자도 추가해주겠습니다. `subsectionExtractor` 파라미터는 api 를 호출했을 때의 결과값에서 필드를 뽑아내는건데, errorResponse 는 그럴 필요가 없기 때문입니다.
</code></pre><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomResponseFieldsSnippet</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractFieldsSnippet</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">CustomResponseFieldsSnippet</span><span class="token punctuation">(</span><span class="token class-name">String</span> type<span class="token punctuation">,</span> <span class="token class-name">PayloadSubsectionExtractor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> subsectionExtractor<span class="token punctuation">,</span></span>
<span class="line">                                       <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FieldDescriptor</span><span class="token punctuation">&gt;</span></span> descriptors<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> attributes<span class="token punctuation">,</span></span>
<span class="line">                                       <span class="token keyword">boolean</span> ignoreUndocumentedFields<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">super</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> descriptors<span class="token punctuation">,</span> attributes<span class="token punctuation">,</span> ignoreUndocumentedFields<span class="token punctuation">,</span> subsectionExtractor<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">//추가된 생성자</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">CustomResponseFieldsSnippet</span><span class="token punctuation">(</span><span class="token class-name">String</span> type<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FieldDescriptor</span><span class="token punctuation">&gt;</span></span> descriptors<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> attributes<span class="token punctuation">,</span></span>
<span class="line">                                       <span class="token keyword">boolean</span> ignoreUndocumentedFields<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">super</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> descriptors<span class="token punctuation">,</span> attributes<span class="token punctuation">,</span> ignoreUndocumentedFields<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token annotation punctuation">@Override</span></span>
<span class="line">    <span class="token keyword">protected</span> <span class="token class-name">MediaType</span> <span class="token function">getContentType</span><span class="token punctuation">(</span><span class="token class-name">Operation</span> operation<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> operation<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContentType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Override</span></span>
<span class="line">    <span class="token keyword">protected</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getContent</span><span class="token punctuation">(</span><span class="token class-name">Operation</span> operation<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> operation<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>CommonDocControllerTest</strong></p><p>이제 최종적으로 Test 에서 코드를 수정해주도록 하겠습니다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">CommonDocControllerTest</span> <span class="token keyword">extends</span> <span class="token class-name">RestDocsTestSupport</span><span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Test</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">errorSample</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">CommonDocController<span class="token punctuation">.</span>SampleRequest</span> sampleRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonDocController<span class="token punctuation">.</span>SampleRequest</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;hhh.naver&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">ResultActions</span> result <span class="token operator">=</span></span>
<span class="line">                mockMvc<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span></span>
<span class="line">                    <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/test/error&quot;</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span>objectMapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>sampleRequest<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isBadRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">//FieldDescriptor 선언</span></span>
<span class="line">        <span class="token class-name">FieldDescriptor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FieldDescriptor</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;에러 메시지&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Error Code&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;errors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Error 값 배열 값&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;errors[].field&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;문제 있는 필드&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;errors[].value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;문제가 있는 값&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token function">fieldWithPath</span><span class="token punctuation">(</span><span class="token string">&quot;errors[].reason&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;문재가 있는 이유&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        result<span class="token punctuation">.</span><span class="token function">andDo</span><span class="token punctuation">(</span>documentHandler<span class="token punctuation">.</span><span class="token function">document</span><span class="token punctuation">(</span></span>
<span class="line">                    <span class="token function">customResponseFields</span><span class="token punctuation">(</span><span class="token string">&quot;exception-response&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                            <span class="token function">attributes</span><span class="token punctuation">(</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Exception&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fields<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    </span>
<span class="line">   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line">       </span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CustomResponseFieldsSnippet</span> <span class="token function">customResponseFields</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token class-name">String</span> type<span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> attributes<span class="token punctuation">,</span> <span class="token class-name">FieldDescriptor</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> descriptors<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CustomResponseFieldsSnippet</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>descriptors<span class="token punctuation">)</span><span class="token punctuation">,</span> attributes<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>customResponseFields</code> 에서 인자가 3개인 것을 볼 수 있습니다. 원래 있던 <code>customResponseFields</code> 에서 메서드 오버로딩한 것입니다.</li><li>exception-response-fields.snippet 을 만들었으니 첫번째 인자로 &quot;exception-response&quot; 를 줘야 합니다. 나머지는 enum 이랑 비슷하게 생각하면 됩니다.</li></ul><h1 id="http-status-code-host-환경-문서화" tabindex="-1"><a class="header-anchor" href="#http-status-code-host-환경-문서화"><span>HTTP status code, host 환경 문서화</span></a></h1><pre><code>마지막으로 제일 첫 페이지에 나올 host 환경, http satus code 설명을 넣어줍니다. src 디렉토리의 docs.asciidoc 에 overview.adoc 으로 만들어주면 됩니다.
</code></pre><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">[[overview]]</span>
<span class="line">== Overview</span>
<span class="line"></span>
<span class="line">[[overview-host]]</span>
<span class="line">=== Host</span>
<span class="line"></span>
<span class="line">|===</span>
<span class="line">| 환경 | Host</span>
<span class="line">| author</span>
<span class="line">| `hobeen-kim`</span>
<span class="line"></span>
<span class="line">| Github</span>
<span class="line">| `hobeen-kim.github.io`</span>
<span class="line">|===</span>
<span class="line"></span>
<span class="line">[[overview-http-status-codes]]</span>
<span class="line">=== HTTP status codes</span>
<span class="line"></span>
<span class="line">|===</span>
<span class="line">| 상태 코드 | 설명</span>
<span class="line"></span>
<span class="line">| `200 OK`</span>
<span class="line">| 성공</span>
<span class="line"></span>
<span class="line">| `201 Created`</span>
<span class="line">| 생성 성공</span>
<span class="line"></span>
<span class="line">| `204 No Content`</span>
<span class="line">| 성공했지만 응답할 데이터 없음</span>
<span class="line"></span>
<span class="line">| `400 Bad Request`</span>
<span class="line">| 잘못된 요청</span>
<span class="line"></span>
<span class="line">| `401 Unauthorized`</span>
<span class="line">| 비인증 상태</span>
<span class="line"></span>
<span class="line">| `403 Forbidden`</span>
<span class="line">| 권한 거부</span>
<span class="line"></span>
<span class="line">| `404 Not Found`</span>
<span class="line">| 존재하지 않는 요청 리소스</span>
<span class="line"></span>
<span class="line">| `500 Internal Server Error`</span>
<span class="line">| 서버 에러</span>
<span class="line">|===</span>
<span class="line"></span>
<span class="line">[[overview-error-response]]</span>
<span class="line">=== HTTP Error Response</span>
<span class="line">operation::CommonDoc/errorSample[snippets=&#39;http-response,exception-response-fields&#39;]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>마지막으로 index.adoc 파일과 member.adoc, post.adoc 파일을 변경된 adoc 파일명에 맞게 수정해줍니다. 아래는 index.adoc 입니다.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">= Rest Docs Practice Application API Document</span>
<span class="line">:doctype: book</span>
<span class="line">:source-highlighter: highlightjs</span>
<span class="line">:toc: left</span>
<span class="line">:toclevels: 2</span>
<span class="line">:sectlinks:</span>
<span class="line">:docinfo: shared-head</span>
<span class="line"></span>
<span class="line">include::overview.adoc[]</span>
<span class="line">include::member.adoc[]</span>
<span class="line">include::post.adoc[]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>참고로 모든 테스트를 한번에 돌리려면 <code>./gradlew test</code> 로 돌리면 됩니다.</p></blockquote><h1 id="마치며" tabindex="-1"><a class="header-anchor" href="#마치며"><span>마치며</span></a></h1><p>최종적으로 아래와 같이 잘 나왔습니다.</p><p><img src="/images/2023-05-14-SpringRestDocs3/image-20230514202852146.png" alt="image-20230514202852146"></p><p>잘 따라오시면 어렵지 않게 간단한 restDocs 를 구현하실 수 있을 것 같습니다. 물론 저도 test 에서나 .adoc 에서 완벽하게 만들었다고 할 수 없지만요. 새로운 툴을 사용하는 건 두려우면서도 재밌습니다.</p><p>다음에는 Swagger 를 포스팅해봐야겠습니다. 아무래도 사람들이 많이 사용하는 건 Swagger 인거같거든요.</p><p><img src="/images/2023-05-14-SpringRestDocs3/image-20230505015725081.png" alt="image-20230505015725081"></p><!----><p>또한 Rest Docs 를 openAPI Spec 으로 변환 후 swagger UI 를 사용할 수도 있다고 합니다. <a href="https://github.com/ePages-de/restdocs-api-spec" target="_blank" rel="noopener noreferrer">github</a> 에서 확인할 수 있습니다.</p><h1 id="ref" tabindex="-1"><a class="header-anchor" href="#ref"><span>Ref.</span></a></h1><p><a href="https://youtu.be/BoVpTSsTuVQ" target="_blank" rel="noopener noreferrer">[10분 테코톡] 승팡, 케이의 REST Docs</a></p><p><a href="https://taetaetae.github.io/2020/03/08/spring-rest-docs-in-spring-boot/" target="_blank" rel="noopener noreferrer">SpringRestDocs를 SpringBoot에 적용하기</a></p><p><a href="https://techblog.woowahan.com/2597/" target="_blank" rel="noopener noreferrer">Spring Rest Docs 적용</a></p><p><a href="https://tecoble.techcourse.co.kr/post/2020-08-18-spring-rest-docs/" target="_blank" rel="noopener noreferrer">API 문서 자동화 - Spring REST Docs 팔아보겠습니다</a></p><p><a href="https://docs.spring.io/spring-restdocs/docs/2.0.4.RELEASE/reference/html5/#getting-started-documentation-snippets-invoking-the-service" target="_blank" rel="noopener noreferrer">공식 문서</a></p><p>+ 추가 : <a href="https://backtony.github.io/spring/2021-10-15-spring-test-3/" target="_blank" rel="noopener noreferrer">Spring REST Docs 적용 및 최적화 하기</a> &lt;- 포스팅 시에는 참고하지 않았지만 이후에도 계속 rest docs 를 공부하면서 찾다보니 제일 도움되는 포스팅입니다.</p><nav class="vp-page-nav" aria-label="page navigation" data-v-63cabaa2><!----><!----></nav></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DEgjeEtj.js" defer></script>
  </body>
</html>
