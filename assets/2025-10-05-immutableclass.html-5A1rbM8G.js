import{_ as o,c as u,a,b as s,d as k,f as p,r as l,o as r,e as t}from"./app-CGooUZ3M.js";const d={},m={class:"table-of-contents"};function v(b,n){const c=l("Header"),e=l("router-link"),i=l("Footer");return r(),u("div",null,[a(c),s("nav",m,[s("ul",null,[s("li",null,[a(e,{to:"#_1-불변-클래스란"},{default:p(()=>n[0]||(n[0]=[t("1. 불변 클래스란?")])),_:1})]),s("li",null,[a(e,{to:"#_2-불변-클래스-구현"},{default:p(()=>n[1]||(n[1]=[t("2. 불변 클래스 구현")])),_:1}),s("ul",null,[s("li",null,[a(e,{to:"#_2-1-getter-에서도-방어적-복사가-필요한-이유"},{default:p(()=>n[2]||(n[2]=[t("2.1 getter 에서도 방어적 복사가 필요한 이유")])),_:1})])])]),s("li",null,[a(e,{to:"#_3-불변-클래스-구현-시-자주-놓치는-부분"},{default:p(()=>n[3]||(n[3]=[t("3. 불변 클래스 구현 시 자주 놓치는 부분")])),_:1}),s("ul",null,[s("li",null,[a(e,{to:"#_3-1-배열-필드-byte-int-는-특히-위험"},{default:p(()=>n[4]||(n[4]=[t("3.1 배열 필드 (byte[], int[])는 특히 위험")])),_:1})]),s("li",null,[a(e,{to:"#_3-2-가변-객체를-필드로-들고-있으면-깊은-불변이-아니다"},{default:p(()=>n[5]||(n[5]=[t("3.2 가변 객체를 필드로 들고 있으면 깊은 불변이 아니다")])),_:1})]),s("li",null,[a(e,{to:"#_3-3-컬렉션-안의-요소가-가변일-때"},{default:p(()=>n[6]||(n[6]=[t("3.3. 컬렉션 안의 요소가 가변일 때")])),_:1})])])]),s("li",null,[a(e,{to:"#_4-마무리"},{default:p(()=>n[7]||(n[7]=[t("4. 마무리")])),_:1})])])]),n[8]||(n[8]=k(`<h2 id="_1-불변-클래스란" tabindex="-1"><a class="header-anchor" href="#_1-불변-클래스란"><span>1. 불변 클래스란?</span></a></h2><p><strong>불변(Immutable) 클래스는 한 번 생성되면 객체 내부의 상태(값)를 변경할 수 없는 클래스</strong>를 말한다. 인스턴스는 생성 시점에 모든 상태가 결정되고, 그 이후에는 값이 절대 바뀌지 않는다. 상태 변경이 필요하다면 기존 인스턴스를 수정하는 대신 새 인스턴스를 새로 만들어 반환하는 방식으로 처리한다.</p><p>자바에서 가장 대표적인 불변 클래스는 String 이다. String 은 문자열을 바꾼다는 개념이라고 느껴지는 여러 연산이 실제로는 새 문자열 객체를 만들어 반환한다.</p><p>불변 객체는 다음과 같은 장점이 있다.</p><ul><li><strong>Thread-safe</strong> : 상태가 변하지 않으니 동기화(synchronized) 없이도 공유하기가 쉽다.</li><li><strong>예측 가능성</strong> : 객체가 어디서 어떻게 변했는지 추적할 필요가 없어서 디버깅이 편하다.</li><li><strong>캐싱/공유에 유리</strong> : 같은 값이면 재사용하기 쉽고, 해시 기반 컬렉션(HashMap, HashSet)에서도 안전하게 쓸 수 있다.</li><li><strong>방어적 프로그래밍에 도움</strong>: 외부에서 몰래 값을 바꾸는 부작용(side effect)을 차단한다.</li></ul><p>반대로 단점도 있다.</p><ul><li>상태 변경이 잦은 경우 객체 생성 비용과 GC 부담이 증가할 수 있다.</li><li>설계가 조금 더 번거롭고(방어적 복사 등), 컬렉션을 다룰 때 신경 쓸 포인트가 늘어난다.</li></ul><h1 id="_2-불변-클래스-구현" tabindex="-1"><a class="header-anchor" href="#_2-불변-클래스-구현"><span>2. 불변 클래스 구현</span></a></h1><p>불변 클래스를 구현하는 기본 규칙은 다음과 같다.</p><ul><li>클래스를 final로 선언해 상속을 막는다. <ul><li>상속이 가능하면 하위 클래스가 내부 상태를 변경 가능한 형태로 확장해버릴 수 있다.</li></ul></li><li>모든 필드를 private final로 선언한다.</li><li>setter를 제공하지 않는다.</li><li>필드가 List, Map, 배열처럼 가변(mutable) 객체라면, <ul><li>생성자에서 defensive copy(방어적 복사)</li><li>getter에서도 defensive copy 를 적용해 외부에서 내부 상태를 바꾸지 못하게 한다.</li></ul></li><li>내부에서 사용하는 가변 필드는 가능하면 불변 컬렉션으로 감싸서 보관한다.</li><li>equals/hashCode/toString 을 구현해 값 객체로의 사용성을 높인다.</li></ul><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> categories<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">Item</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> categories<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">&quot;name must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>categories<span class="token punctuation">,</span> <span class="token string">&quot;categories must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// defensive copy + (선택) unmodifiable로 감싸 내부 보관</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>categories <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">unmodifiableList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>categories<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> name<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCategories</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 내부에서 unmodifiable로 보관하고 있다면 그대로 반환해도 안전</span></span>
<span class="line">        <span class="token keyword">return</span> categories<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// &quot;변경&quot;이 필요하면 새 객체를 만들어 반환</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">Item</span> <span class="token function">withName</span><span class="token punctuation">(</span><span class="token class-name">String</span> newName<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Item</span><span class="token punctuation">(</span>newName<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>categories<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">Item</span> <span class="token function">withAddedCategory</span><span class="token punctuation">(</span><span class="token class-name">String</span> category<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> next <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>categories<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        next<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Item</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Override</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>o <span class="token keyword">instanceof</span> <span class="token class-name">Item</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">Item</span> item <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Item</span><span class="token punctuation">)</span> o<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> categories<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>categories<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Override</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> categories<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Override</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&quot;Item{name=&#39;&quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;&#39;, categories=&quot;</span> <span class="token operator">+</span> categories <span class="token operator">+</span> <span class="token char">&#39;}&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-1-getter-에서도-방어적-복사가-필요한-이유" tabindex="-1"><a class="header-anchor" href="#_2-1-getter-에서도-방어적-복사가-필요한-이유"><span>2.1 getter 에서도 방어적 복사가 필요한 이유</span></a></h2><p>불변 객체에서 getter 를 방어적 복사하지 않으면 필드의 객체 내부가 변경될 수도 있다. 예를 들어 내부 필드를 아래처럼 그냥 반환하면,</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCategories</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword">return</span> categories<span class="token punctuation">;</span> <span class="token comment">// 위험!</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>외부에서 이렇게 바꿀 수 있다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token class-name">Item</span> item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Item</span><span class="token punctuation">(</span><span class="token string">&quot;keyboard&quot;</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;input&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">item<span class="token punctuation">.</span><span class="token function">getCategories</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;hacked&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 내부 리스트가 mutable이면 상태가 깨짐</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>그래서 두 가지 전략 중 하나를 선택한다.</p><p><strong>전략 A - getter에서 매번 복사해서 반환</strong></p><p><code>return new ArrayList&lt;&gt;(categories);</code></p><p>단, 호출이 잦으면 복사 비용이 생긴다.</p><p><strong>전략 B - 생성자에서 불변 컬렉션으로 만들어 보관하고 그대로 반환</strong></p><p><code>Collections.unmodifiableList(new ArrayList&lt;&gt;(categories))</code></p><p>훨씬 흔하게 쓰는 방식이다. (반환 비용이 거의 없음). 위 예시는 B 를 적용했다.</p><blockquote><p><strong>주의</strong></p><p>Collections.unmodifiableList(...)는 진짜 불변 리스트를 만드는 게 아니라 수정 메서드 호출을 막는 뷰(view)다. 그래서 원본 리스트를 그대로 감싸면 안 되고, 반드시 new ArrayList&lt;&gt;(...) 같은 복사본을 감싼 뒤 보관해야 한다.</p></blockquote><h1 id="_3-불변-클래스-구현-시-자주-놓치는-부분" tabindex="-1"><a class="header-anchor" href="#_3-불변-클래스-구현-시-자주-놓치는-부분"><span>3. 불변 클래스 구현 시 자주 놓치는 부분</span></a></h1><p>불변 클래스 구현 시 자주 놓치는 패턴들이다.</p><h2 id="_3-1-배열-필드-byte-int-는-특히-위험" tabindex="-1"><a class="header-anchor" href="#_3-1-배열-필드-byte-int-는-특히-위험"><span>3.1 배열 필드 (byte[], int[])는 특히 위험</span></a></h2><p>배열은 대표적인 가변 객체라서 방어적 복사가 필수다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Token</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> value<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">Token</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// defensive copy</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// defensive copy</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-2-가변-객체를-필드로-들고-있으면-깊은-불변이-아니다" tabindex="-1"><a class="header-anchor" href="#_3-2-가변-객체를-필드로-들고-있으면-깊은-불변이-아니다"><span>3.2 가변 객체를 필드로 들고 있으면 깊은 불변이 아니다</span></a></h2><p>예를 들어 LocalDateTime 같은 건 불변이라 괜찮지만, Date(java.util.Date)처럼 가변인 객체는 그대로 들고 있으면 위험하다. 이런 경우도 방어적 복사가 필요하다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Event</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span> when<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token class-name">Date</span> when<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>when <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span><span class="token punctuation">(</span>when<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">Date</span> <span class="token function">getWhen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span><span class="token punctuation">(</span>when<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-3-컬렉션-안의-요소가-가변일-때" tabindex="-1"><a class="header-anchor" href="#_3-3-컬렉션-안의-요소가-가변일-때"><span>3.3. 컬렉션 안의 요소가 가변일 때</span></a></h2><p>List Person 에서 Person이 mutable이면, 리스트 자체는 못 바꿔도 요소는 바뀔 수 있다.</p><ul><li>얕은 불변(shallow immutability): 컬렉션 구조만 안 바뀜 (추가/삭제 불가)</li><li>깊은 불변(deep immutability): 요소 객체까지 불변</li></ul><p>깊은 불변이 필요하다면, 요소 타입도 불변으로 설계하거나, 요소를 복사해서 들고 있어야 한다.</p><h1 id="_4-마무리" tabindex="-1"><a class="header-anchor" href="#_4-마무리"><span>4. 마무리</span></a></h1><p>불변 클래스는 단순히 final을 붙이는 수준이 아니라, 외부에서 내부 상태에 접근해 바꿀 수 있는 모든 경로를 차단하는 것이 핵심이다. 특히 컬렉션/배열/가변 타입 필드에서는 방어적 복사를 습관처럼 적용해야 한다.</p><p>정리하면,</p><ul><li>final class</li><li>private final 필드</li><li>setter 없음</li><li>가변 필드면 복사해서 보관 + 불변 형태로 노출</li><li>변경이 필요하면 withXxx()처럼 새 객체 반환</li></ul>`,40)),a(i)])}const y=o(d,[["render",v],["__file","2025-10-05-immutableclass.html.vue"]]),h=JSON.parse('{"path":"/posts/java/2025-10-05-immutableclass.html","title":"[구현] 불변 클래스 구현","lang":"en-US","frontmatter":{"title":"[구현] 불변 클래스 구현","date":"2025-10-05T00:00:00.000Z","tags":["java","immutable"],"description":"불변 클래스를 구현해보자"},"headers":[{"level":2,"title":"1. 불변 클래스란?","slug":"_1-불변-클래스란","link":"#_1-불변-클래스란","children":[]},{"level":1,"title":"2. 불변 클래스 구현","slug":"_2-불변-클래스-구현","link":"#_2-불변-클래스-구현","children":[{"level":2,"title":"2.1 getter 에서도 방어적 복사가 필요한 이유","slug":"_2-1-getter-에서도-방어적-복사가-필요한-이유","link":"#_2-1-getter-에서도-방어적-복사가-필요한-이유","children":[]}]},{"level":1,"title":"3. 불변 클래스 구현 시 자주 놓치는 부분","slug":"_3-불변-클래스-구현-시-자주-놓치는-부분","link":"#_3-불변-클래스-구현-시-자주-놓치는-부분","children":[{"level":2,"title":"3.1 배열 필드 (byte[], int[])는 특히 위험","slug":"_3-1-배열-필드-byte-int-는-특히-위험","link":"#_3-1-배열-필드-byte-int-는-특히-위험","children":[]},{"level":2,"title":"3.2 가변 객체를 필드로 들고 있으면 깊은 불변이 아니다","slug":"_3-2-가변-객체를-필드로-들고-있으면-깊은-불변이-아니다","link":"#_3-2-가변-객체를-필드로-들고-있으면-깊은-불변이-아니다","children":[]},{"level":2,"title":"3.3. 컬렉션 안의 요소가 가변일 때","slug":"_3-3-컬렉션-안의-요소가-가변일-때","link":"#_3-3-컬렉션-안의-요소가-가변일-때","children":[]}]},{"level":1,"title":"4. 마무리","slug":"_4-마무리","link":"#_4-마무리","children":[]}],"git":{},"filePathRelative":"_posts/java/2025-10-05-immutableclass.md"}');export{y as comp,h as data};
