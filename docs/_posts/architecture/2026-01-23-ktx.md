---
title: "[아키텍처] KTX 예약 시스템 설계"
date: 2026-01-23
tags:
  - ktx
  - architecture
  - reservation
description: "ktx 예약 시스템을 설계해보자"
---
<Header />

[[toc]]

아키텍처 항목의 첫 포스트로 KTX 예약 시스템을 설계해보겠다. KTX 예약 시스템은 동시성을 관리하는 데에 있어서는 극한이라고 볼 수 있다. 명절 예매를 하기 위해 수백만 명의 접속이 동시에 몰리는데 하나의 오차도 없이 들어온 순서대로 좌석 선택과 예매를 진행해야 하기 때문이다.

## 1. 핵심 가치 및 기능

내가 생각하는 핵심가치는 다음과 같다.

- 모든 사용자는 예기치 않은 서버 오류없이 좌석 선택 - 예매 - 결제를 완료해야 한다.
- 먼저 들어온 사용자는 이후 사용자보다 먼저 좌석을 선택할 수 있어야 한다.

즉, **장애 대응**과 **순서 보장**이다.

### 1.1 기능

**예매 대기**

- 사용자 중 1만명은 예매 페이지로 진입할 수 있다.
- 나머지 사용자는 예매 대기 페이지에서 순서를 기다린다. 이때 예매 대기 페이지로 진입한 순서대로 예매 페이지로 진입한다.
- 예매 대기 페이지의 사용자는 자신의 순서와 총 대기자 수를 알 수 있다.
- 예매 대기 페이지의 사용자가 해당 페이지를 이탈하면 순서에서 빠진다. (재진입 시 제일 후순위로 진입한다.)

**예매**

- 사용자는 예매 페이지에서 호차와 좌석을 선택할 수 있다.
- 좌석을 선택하고 결제 버튼을 누르는 시점에 해당 좌석을 선점한다.

**결제**

- 결제는 10분 안에 완료되어야 하며 결제되지 않으면 좌석인 비선점 상태로 복구된다.

### 1.2 규모 예측

(명절을 기준으로 한다.)

- 명절 열차는 당일의 D-28일 12시에 예매할 수 있다.
- 예매를 시도하려는 사람은 200만 명이며 100만명은 1분 이내에, 나머지 100만명은 10분 이내에 모두 접속한다.
- 접속 후 예매 및 결제 플로우는 다음과 같다.
  - 예매 페이지 접속 -> 호차 선택 -> 좌석 선택 -> 결제
  - 접속이 원활하다면 1분 정도 걸리는 플로우이다.
- 1분 내에 100만 명이 동시에 접속한다면 평균적인 TPS 를 구하기 어려우나, 최대 100만 TPS 라고 가정한다.

## 2. 간단한 설계

## 3. 상세한 설계

## 4. 구현

## 5. 참고 자료

- https://www.youtube.com/watch?v=c-ERjEodn_o



<Footer />