<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>kakao ëŠ” ì™œ OAuth API ìŠ¤í™ì´ ë‹¤ë¥¼ê¹Œ(ì§„ì§œ ëª¨ë¦„) | ì•¤ë””  ë¸”ë¡œê·¸ (ë¸”ë¡œê·¸ ê³µì‚¬ì¤‘)ğŸš§</title><meta name="description" content="OAuth2 ë¡œê·¸ì¸ì„ êµ¬í˜„í•˜ë©´ì„œ ë§ˆì£¼ì¹œ Token ë°œê¸‰ ë¬¸ì œ">
    <link rel="preload" href="/assets/style-DzLoKC0N.css" as="style"><link rel="stylesheet" href="/assets/style-DzLoKC0N.css">
    <link rel="modulepreload" href="/assets/app-CKu5hC18.js"><link rel="modulepreload" href="/assets/2025-02-13-security.html-D4Q4wvqh.js">
    <link rel="prefetch" href="/assets/index.html-C2yc2jYE.js" as="script"><link rel="prefetch" href="/assets/index.html-BZkxbdCy.js" as="script"><link rel="prefetch" href="/assets/index.html-x-btwRfz.js" as="script"><link rel="prefetch" href="/assets/index.html-B5VLphlB.js" as="script"><link rel="prefetch" href="/assets/2025-02-08-whatiswork.html-Dctwfzed.js" as="script"><link rel="prefetch" href="/assets/2025-02-11-kafka.html-DI3WB7LD.js" as="script"><link rel="prefetch" href="/assets/2025-02-16-object.html-BGj-RERm.js" as="script"><link rel="prefetch" href="/assets/2025-03-03-skilloflove.html-9-TNwJOL.js" as="script"><link rel="prefetch" href="/assets/2025-03-08-terraform.html-DxbvP0_g.js" as="script"><link rel="prefetch" href="/assets/2025-03-09-software.html-BTviBMfo.js" as="script"><link rel="prefetch" href="/assets/2025-03-23-chosun.html-CEJPOYxi.js" as="script"><link rel="prefetch" href="/assets/2025-02-07-ze.html-5uywsO13.js" as="script"><link rel="prefetch" href="/assets/2025-02-10-firstlog.html-DHqThykO.js" as="script"><link rel="prefetch" href="/assets/2025-02-14-log.html-DhK5qjGQ.js" as="script"><link rel="prefetch" href="/assets/2025-02-23-anna.html-DidbmVz5.js" as="script"><link rel="prefetch" href="/assets/2025-03-02-bystander.html-CKqQOLzQ.js" as="script"><link rel="prefetch" href="/assets/2025-04-08-k8s.html-BU6Akk4N.js" as="script"><link rel="prefetch" href="/assets/2025-04-20-log.html-Ch-Tso3j.js" as="script"><link rel="prefetch" href="/assets/2025-03-15-filesystem.html-eQ13WQ80.js" as="script"><link rel="prefetch" href="/assets/2025-05-04-awsregion.html-Dg3Fd4QP.js" as="script"><link rel="prefetch" href="/assets/2025-06-27-iot.html-D7jMry8W.js" as="script"><link rel="prefetch" href="/assets/index.html-BIvqWNmh.js" as="script"><link rel="prefetch" href="/assets/2025-02-25-aws.html-NhbsI48S.js" as="script"><link rel="prefetch" href="/assets/2025-03-13-aws.html-DyDNkcOw.js" as="script"><link rel="prefetch" href="/assets/2025-03-20-aws.html-BviELc_G.js" as="script"><link rel="prefetch" href="/assets/index.html-Ddq5kQ57.js" as="script"><link rel="prefetch" href="/assets/2025-04-20-leteraljoin.html-CZbvZLEo.js" as="script"><link rel="prefetch" href="/assets/index.html-K94BRg1r.js" as="script"><link rel="prefetch" href="/assets/2025-02-03-post.html-BuYmznq-.js" as="script"><link rel="prefetch" href="/assets/index.html-Vs7naaSk.js" as="script"><link rel="prefetch" href="/assets/2025-02-01-post.html-Couy7-fb.js" as="script"><link rel="prefetch" href="/assets/2025-02-02-post.html-ClY_O3gt.js" as="script"><link rel="prefetch" href="/assets/2025-06-25-alarm.html-CDnb-pbc.js" as="script"><link rel="prefetch" href="/assets/2025-07-20-ssewebsocket.html-CErmvnjz.js" as="script"><link rel="prefetch" href="/assets/2025-08-05-test1.html-B2J20jQS.js" as="script"><link rel="prefetch" href="/assets/index.html-CKHgkT-i.js" as="script"><link rel="prefetch" href="/assets/404.html-B--4G_B0.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-hYnvWAVR.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="vp-site-name" aria-hidden="true">ì•¤ë””  ë¸”ë¡œê·¸ (ë¸”ë¡œê·¸ ê³µì‚¬ì¤‘)ğŸš§</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="ê¸€"><span class="title">ê¸€</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="ê¸€"><span class="title">ê¸€</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/" aria-label="ëª¨ë‘"><!--[--><!--[--><!--]--><!--]-->ëª¨ë‘<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/kafka/" aria-label="ì¹´í”„ì¹´"><!--[--><!--[--><!--]--><!--]-->ì¹´í”„ì¹´<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/spring/" aria-label="ìŠ¤í”„ë§"><!--[--><!--[--><!--]--><!--]-->ìŠ¤í”„ë§<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/cloud/" aria-label="í´ë¼ìš°ë“œ"><!--[--><!--[--><!--]--><!--]-->í´ë¼ìš°ë“œ<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/database/" aria-label="ë°ì´í„°ë² ì´ìŠ¤"><!--[--><!--[--><!--]--><!--]-->ë°ì´í„°ë² ì´ìŠ¤<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/conference/" aria-label="ì»¨í¼ëŸ°ìŠ¤"><!--[--><!--[--><!--]--><!--]-->ì»¨í¼ëŸ°ìŠ¤<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/books/" aria-label="ì±…"><!--[--><!--[--><!--]--><!--]-->ì±…<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/logs/" aria-label="ì§§ì€ ê¸€"><!--[--><!--[--><!--]--><!--]-->ì§§ì€ ê¸€<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="ê¸€"><span class="title">ê¸€</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="ê¸€"><span class="title">ê¸€</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/" aria-label="ëª¨ë‘"><!--[--><!--[--><!--]--><!--]-->ëª¨ë‘<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/kafka/" aria-label="ì¹´í”„ì¹´"><!--[--><!--[--><!--]--><!--]-->ì¹´í”„ì¹´<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/spring/" aria-label="ìŠ¤í”„ë§"><!--[--><!--[--><!--]--><!--]-->ìŠ¤í”„ë§<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/cloud/" aria-label="í´ë¼ìš°ë“œ"><!--[--><!--[--><!--]--><!--]-->í´ë¼ìš°ë“œ<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/database/" aria-label="ë°ì´í„°ë² ì´ìŠ¤"><!--[--><!--[--><!--]--><!--]-->ë°ì´í„°ë² ì´ìŠ¤<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/conference/" aria-label="ì»¨í¼ëŸ°ìŠ¤"><!--[--><!--[--><!--]--><!--]-->ì»¨í¼ëŸ°ìŠ¤<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/books/" aria-label="ì±…"><!--[--><!--[--><!--]--><!--]-->ì±…<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/logs/" aria-label="ì§§ì€ ê¸€"><!--[--><!--[--><!--]--><!--]-->ì§§ì€ ê¸€<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">kakao ëŠ” ì™œ OAuth API ìŠ¤í™ì´ ë‹¤ë¥¼ê¹Œ(ì§„ì§œ ëª¨ë¦„) <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#_1-á„†á…®á†«á„Œá…¦á„‰á…¡á†¼á„’á…ªá†¼" aria-label="1. ë¬¸ì œìƒí™©"><!--[--><!--[--><!--]--><!--]-->1. ë¬¸ì œìƒí™©<!--[--><!--[--><!--]--><!--]--></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#_1-1-á„†á…®á†«á„Œá…¦-á„‡á…¡á†¯á„€á…§á†«" aria-label="1.1 ë¬¸ì œ ë°œê²¬"><!--[--><!--[--><!--]--><!--]-->1.1 ë¬¸ì œ ë°œê²¬<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#_2-á„’á…¢á„€á…§á†¯-á„‡á…¡á†¼á„‡á…¥á†¸" aria-label="2. í•´ê²° ë°©ë²•"><!--[--><!--[--><!--]--><!--]-->2. í•´ê²° ë°©ë²•<!--[--><!--[--><!--]--><!--]--></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#_2-1-oauth2accesstokenresponseclient" aria-label="2.1 OAuth2AccessTokenResponseClient"><!--[--><!--[--><!--]--><!--]-->2.1 OAuth2AccessTokenResponseClient<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#_2-2-securityconfig" aria-label="2.2 SecurityConfig"><!--[--><!--[--><!--]--><!--]-->2.2 SecurityConfig<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#_3-á„€á…®á„á…¦á„Œá…¥á†¨á„‹á…µá†«-á„á…©á„ƒá…³" aria-label="3. êµ¬ì²´ì ì¸ ì½”ë“œ"><!--[--><!--[--><!--]--><!--]-->3. êµ¬ì²´ì ì¸ ì½”ë“œ<!--[--><!--[--><!--]--><!--]--></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#_3-1-oauth2authorizationcodegrantrequestentityconverter" aria-label="3.1 OAuth2AuthorizationCodeGrantRequestEntityConverter"><!--[--><!--[--><!--]--><!--]-->3.1 OAuth2AuthorizationCodeGrantRequestEntityConverter<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#_3-2-customtokenresponseclient" aria-label="3.2 CustomTokenResponseClient"><!--[--><!--[--><!--]--><!--]-->3.2 CustomTokenResponseClient<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#_4-á„€á…§á†¯á„…á…©á†«" aria-label="4. ê²°ë¡ "><!--[--><!--[--><!--]--><!--]-->4. ê²°ë¡ <!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><header class="page-header" data-v-84f05ea1><h1 class="title" data-v-84f05ea1>kakao ëŠ” ì™œ OAuth API ìŠ¤í™ì´ ë‹¤ë¥¼ê¹Œ(ì§„ì§œ ëª¨ë¦„)</h1><div class="meta" data-v-84f05ea1><time data-v-84f05ea1>2025ë…„ 2ì›” 13ì¼</time></div></header><nav class="table-of-contents"><ul><li><a aria-current="page" href="/posts/spring/2025-02-13-security.html#_1-á„†á…®á†«á„Œá…¦á„‰á…¡á†¼á„’á…ªá†¼" class="router-link-active router-link-exact-active">1. ë¬¸ì œìƒí™©</a><ul><li><a aria-current="page" href="/posts/spring/2025-02-13-security.html#_1-1-á„†á…®á†«á„Œá…¦-á„‡á…¡á†¯á„€á…§á†«" class="router-link-active router-link-exact-active">1.1 ë¬¸ì œ ë°œê²¬</a></li></ul></li><li><a aria-current="page" href="/posts/spring/2025-02-13-security.html#_2-á„’á…¢á„€á…§á†¯-á„‡á…¡á†¼á„‡á…¥á†¸" class="router-link-active router-link-exact-active">2. í•´ê²° ë°©ë²•</a><ul><li><a aria-current="page" href="/posts/spring/2025-02-13-security.html#_2-1-oauth2accesstokenresponseclient" class="router-link-active router-link-exact-active">2.1 OAuth2AccessTokenResponseClient</a></li><li><a aria-current="page" href="/posts/spring/2025-02-13-security.html#_2-2-securityconfig" class="router-link-active router-link-exact-active">2.2 SecurityConfig</a></li></ul></li><li><a aria-current="page" href="/posts/spring/2025-02-13-security.html#_3-á„€á…®á„á…¦á„Œá…¥á†¨á„‹á…µá†«-á„á…©á„ƒá…³" class="router-link-active router-link-exact-active">3. êµ¬ì²´ì ì¸ ì½”ë“œ</a><ul><li><a aria-current="page" href="/posts/spring/2025-02-13-security.html#_3-1-oauth2authorizationcodegrantrequestentityconverter" class="router-link-active router-link-exact-active">3.1 OAuth2AuthorizationCodeGrantRequestEntityConverter</a></li><li><a aria-current="page" href="/posts/spring/2025-02-13-security.html#_3-2-customtokenresponseclient" class="router-link-active router-link-exact-active">3.2 CustomTokenResponseClient</a></li></ul></li><li><a aria-current="page" href="/posts/spring/2025-02-13-security.html#_4-á„€á…§á†¯á„…á…©á†«" class="router-link-active router-link-exact-active">4. ê²°ë¡ </a></li></ul></nav><h1 id="_1-á„†á…®á†«á„Œá…¦á„‰á…¡á†¼á„’á…ªá†¼" tabindex="-1"><a class="header-anchor" href="#_1-á„†á…®á†«á„Œá…¦á„‰á…¡á†¼á„’á…ªá†¼"><span>1. ë¬¸ì œìƒí™©</span></a></h1><p>SpringSecurity ë¡œ ì„¸ì…˜ ë¡œê·¸ì¸, Jwt ë¡œê·¸ì¸, OAuth2 ë“±ë“± ë§ì€ ë°©ë²•ìœ¼ë¡œ ë¡œê·¸ì¸ì„ êµ¬í˜„í•´ë´¤ì§€ë§Œ ì œì¼ ê·€ì°®ì€ ê±´ OAuth2 ì´ë‹¤. ì™¸ë¶€ API ì™€ ì—°ë™í•´ì•¼ í•´ì„œ í…ŒìŠ¤íŠ¸ë„ ì–´ë ¤ìš´ ë°ë‹¤ê°€ ì²˜ìŒì—” í”Œë¡œìš°ë„ ì˜ ì´í•´ê°€ ì•ˆë˜ê¸° ë•Œë¬¸ì´ë‹¤.</p><p>ì´ì œëŠ” ì–´ëŠì •ë„ ìµìˆ™í•´ì ¸ì„œ ê°„ë‹¨íˆ ì„¤ì •íŒŒì¼ê³¼ ì»¤ìŠ¤í…€ í•¸ë“¤ëŸ¬ë¡œ OAuth ë¡œê·¸ì¸ì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ì´ë²ˆì— ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ êµ¬í˜„í•˜ë©´ì„œ ì¹´ì¹´ì˜¤ëŠ” ë³„ë„ì˜ ì¶”ê°€ì ì¸ ì„¤ì •ì´ í•„ìš”í•˜ë‹¤ëŠ”ê±¸ ë°œê²¬í–ˆë‹¤.</p><h2 id="_1-1-á„†á…®á†«á„Œá…¦-á„‡á…¡á†¯á„€á…§á†«" tabindex="-1"><a class="header-anchor" href="#_1-1-á„†á…®á†«á„Œá…¦-á„‡á…¡á†¯á„€á…§á†«"><span>1.1 ë¬¸ì œ ë°œê²¬</span></a></h2><p>naver ì™€ kakao ë¥¼ êµ¬í˜„í•˜ë©´ì„œ naver ëŠ” ë³„ë„ ì„¤ì •ì—†ì´ ì¸ì¦í† í° ë°œê¸‰ì´ ì˜ ë˜ëŠ”ë° kakao ëŠ” ì—ëŸ¬ ë©”ì‹œì§€ë„ ì—†ì´ ì§„í–‰ì´ ë˜ì§€ ì•Šì•˜ë‹¤. ê·¸ë˜ì„œ RestTemplate ì˜ ë¡œê¹… ë ˆë²¨ì„ DEBUG ë¡œ ì„¤ì •í•˜ê³  API ë¥¼ í™•ì¸í–ˆë‹¤.</p><blockquote><p><code>logging.level.org.springframework.web.client.RestTemplate=DEBUG</code> ì¶”ê°€</p></blockquote><p>í™•ì¸í•´ë³´ë‹ˆ <code>https://kauth.kakao.com/oauth/token</code> ì„ ìš”ì²­í•˜ëŠ” ê³¼ì •ì—ì„œ 401 ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤. DEBUG ë¡œ ì„¤ì •í•˜ë©´ Request ì˜ Body ê°’ë„ ë³¼ ìˆ˜ ìˆëŠ”ë° grant_type, code, redirect_uri ê°€ ë“¤ì–´ê°€ìˆë‹¤. ì´ê²Œ êµ¬ê¸€ì´ë“  ë„¤ì´ë²„ë“  ê¸°ë³¸ì ìœ¼ë¡œ ì¸ì¦í† í°ì„ ë°œê¸‰ë°›ì„ ë•Œì˜ í•„ìˆ˜ ìš”ì†Œì´ë‹¤. <strong>í•˜ì§€ë§Œ ì¹´ì¹´ì˜¤ëŠ” ë‹¬ëë‹¤.</strong></p><p><img src="/images/2025-02-13-security/image-20250213220050372.png" alt="image-20250213220050372"></p><p>ìœ„ì—ì„œ ë³´ë“¯ì´ &#39;client_id&#39;ë„ í¬í•¨ì‚¬í•­ì´ë‹¤. ê·¸ë˜ì„œ ê³„ì† 401 ì—ëŸ¬ê°€ ë‚œ ê²ƒì´ë‹¤.</p><h1 id="_2-á„’á…¢á„€á…§á†¯-á„‡á…¡á†¼á„‡á…¥á†¸" tabindex="-1"><a class="header-anchor" href="#_2-á„’á…¢á„€á…§á†¯-á„‡á…¡á†¼á„‡á…¥á†¸"><span>2. í•´ê²° ë°©ë²•</span></a></h1><p>ë¬¸ì œë¥¼ ì°¾ì•˜ìœ¼ë‹ˆ í•´ê²°í•˜ê¸°ëŠ” ì‰½ë‹¤. token-uri ì„ í˜¸ì¶œí•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ì°¾ì€ ë’¤ ì»¤ìŠ¤í…€ìœ¼ë¡œ ë³€ê²½í•´ì£¼ë©´ ëœë‹¤.</p><h2 id="_2-1-oauth2accesstokenresponseclient" tabindex="-1"><a class="header-anchor" href="#_2-1-oauth2accesstokenresponseclient"><span>2.1 OAuth2AccessTokenResponseClient</span></a></h2><p>ì¸ì¦ í† í°ì€ <code>OAuth2AccessTokenResponseClient</code> ì—ì„œ API ë¥¼ ìš”ì²­í•´ ë°œê¸‰ë°›ëŠ”ë‹¤. ì¢€ ë” ìì„¸íˆ ë§í•˜ìë©´, í•´ë‹¹ í´ë˜ìŠ¤ì—ì„œ ì¸ì¦ì •ë³´(authorizationCodeGrantRequest)ë¥¼ ì¡°í•©í•´ì„œ HTTP ìš”ì²­ìœ¼ë¡œ ë§Œë“œëŠ”ë° ì´ëŠ” requestEntityConverter ë¡œ ì´ë£¨ì–´ì§„ë‹¤. ê·¸ë¦¬ê³  restTemplate ìœ¼ë¡œ ìš”ì²­ì´ ì´ë£¨ì–´ì§„ë‹¤.</p><p><em>ëŒ€ëµì ì¸ pseudo code ë¡œ í™•ì¸í•´ë³´ë©´,</em></p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt" data-title="kt"><pre><code><span class="line"><span class="token keyword">class</span> OAuth2AccessTokenResponseClient <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">//í† í°ì„ ê°€ì ¸ì˜¤ëŠ” ë©”ì„œë“œ</span></span>
<span class="line">	<span class="token keyword">fun</span> <span class="token function">getTokenResponse</span><span class="token punctuation">(</span>ì¸ì¦ì •ë³´<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword">val</span> httpRequest <span class="token operator">=</span> converter<span class="token punctuation">.</span><span class="token function">toHttpRequest</span><span class="token punctuation">(</span>ì¸ì¦ì •ë³´<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line highlighted">    httpRequest<span class="token punctuation">.</span><span class="token function">addBody</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;client_id&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;abfup72345by8gfs&quot;</span></span><span class="token punctuation">)</span> <span class="token comment">//client_id ì¶”ê°€</span></span>
<span class="line">		</span>
<span class="line">		<span class="token keyword">val</span> response <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span>httpRequest<span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ì¸ì¦ì •ë³´ë¥¼ ë°›ìœ¼ë©´ í•´ë‹¹ ì •ë³´ ë‚´ì— grant_type, redirect_uri, code ë“±ì´ ìˆìœ¼ë‹ˆ http body ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤. <strong>ë‚˜ëŠ” ì´ë ‡ê²Œ ì¤‘ê°„ì— client_id ë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í–ˆë‹¤.</strong></p><blockquote><p><strong>ì°¸ê³ </strong></p><p>í•´ë‹¹ ê³¼ì •ì€ OAuth2LoginAuthenticationFilter ì˜ attemptAuthentication() ì—ì„œ ì§„í–‰ëœë‹¤. í•„í„° ë‚´ì—ì„œ í† í° ì¸ì¦, ìœ ì € ì •ë³´ ê°€ì ¸ì˜¤ê¸°ê°€ ëª¨ë‘ ì§„í–‰ëœ í›„ SuccessHandler ë¡œ ì´ë™í•œë‹¤. ì‹¤íŒ¨í•˜ë©´ ë‹¹ì—°íˆ FailureHandler ë¡œ ì´ë™í•œë‹¤.</p></blockquote><h2 id="_2-2-securityconfig" tabindex="-1"><a class="header-anchor" href="#_2-2-securityconfig"><span>2.2 SecurityConfig</span></a></h2><p>ì•„ë˜ì™€ ê°™ì´ tokenEndpoint ë¡œ accessTokenResponseClient ì„ ì»¤ìŠ¤í…€ìœ¼ë¡œ ë„£ì„ ìˆ˜ ìˆë‹¤.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line">http<span class="token punctuation">.</span><span class="token function">oauth2Login</span><span class="token punctuation">(</span>oauth2 <span class="token operator">-&gt;</span> oauth2</span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">authorizationEndpoint</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">tokenEndpoint</span><span class="token punctuation">(</span>token <span class="token operator">-&gt;</span> token<span class="token punctuation">.</span><span class="token function">accessTokenResponseClient</span><span class="token punctuation">(</span><span class="token function">customTokenResponseClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">successHandler</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">failureHandler</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ì´ì œ ì¹´ì¹´ì˜¤ë¡œ ìš”ì²­í•˜ë©´ client_id ê°€ ì˜ ë“¤ì–´ê°„ë‹¤!</p><h1 id="_3-á„€á…®á„á…¦á„Œá…¥á†¨á„‹á…µá†«-á„á…©á„ƒá…³" tabindex="-1"><a class="header-anchor" href="#_3-á„€á…®á„á…¦á„Œá…¥á†¨á„‹á…µá†«-á„á…©á„ƒá…³"><span>3. êµ¬ì²´ì ì¸ ì½”ë“œ</span></a></h1><p><code>OAuth2AccessTokenResponseClient</code> ë§Œ ìì„¸íˆ ì‚´í´ë³´ì. <code>OAuth2AccessTokenResponseClient</code> ì˜ ê¸°ë³¸ êµ¬í˜„ì²´ëŠ” <code>DefaultAuthorizationCodeTokenResponseClient</code> ì´ë‹¤.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token class-name">OAuth2AccessTokenResponse</span> <span class="token function">getTokenResponse</span><span class="token punctuation">(</span><span class="token class-name">OAuth2AuthorizationCodeGrantRequest</span> authorizationCodeGrantRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>authorizationCodeGrantRequest<span class="token punctuation">,</span> <span class="token string">&quot;authorizationCodeGrantRequest cannot be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">RequestEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> request <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">RequestEntity</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>requestEntityConverter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>authorizationCodeGrantRequest<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OAuth2AccessTokenResponse</span><span class="token punctuation">&gt;</span></span> response <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">OAuth2AccessTokenResponse</span> tokenResponse <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">OAuth2AccessTokenResponse</span><span class="token punctuation">)</span>response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>tokenResponse<span class="token punctuation">,</span> <span class="token string">&quot;The authorization server responded to this Authorization Code grant request with an empty body; as such, it cannot be materialized into an OAuth2AccessTokenResponse instance. Please check the HTTP response code in your server logs for more details.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> tokenResponse<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>getTokenResponse() ë©”ì„œë“œë§Œ ë³´ë©´, this.requestEntityConverter.convert(authorizationCodeGrantRequest) ë¥¼ í†µí•´ RequestEntity ë¥¼ ë§Œë“ ë‹¤. ê·¸ë ‡ë‹¤ë©´ requestEntityConverter ë¥¼ ì»¤ìŠ¤í…€ìœ¼ë¡œ ë„£ì–´ì¤˜ë„ ëœë‹¤ëŠ” ì–˜ê¸°ì´ë‹¤.</p><p>converter ì˜ êµ¬í˜„ì²´ëŠ” <code>OAuth2AuthorizationCodeGrantRequestEntityConverter</code> ê°€ ë“¤ì–´ê°„ë‹¤.</p><h2 id="_3-1-oauth2authorizationcodegrantrequestentityconverter" tabindex="-1"><a class="header-anchor" href="#_3-1-oauth2authorizationcodegrantrequestentityconverter"><span>3.1 OAuth2AuthorizationCodeGrantRequestEntityConverter</span></a></h2><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">protected</span> <span class="token class-name">MultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">createParameters</span><span class="token punctuation">(</span><span class="token class-name">OAuth2AuthorizationCodeGrantRequest</span> authorizationCodeGrantRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">ClientRegistration</span> clientRegistration <span class="token operator">=</span> authorizationCodeGrantRequest<span class="token punctuation">.</span><span class="token function">getClientRegistration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">OAuth2AuthorizationExchange</span> authorizationExchange <span class="token operator">=</span> authorizationCodeGrantRequest<span class="token punctuation">.</span><span class="token function">getAuthorizationExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">MultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> parameters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedMultiValueMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        parameters<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;grant_type&quot;</span><span class="token punctuation">,</span> authorizationCodeGrantRequest<span class="token punctuation">.</span><span class="token function">getGrantType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        parameters<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> authorizationExchange<span class="token punctuation">.</span><span class="token function">getAuthorizationResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">String</span> redirectUri <span class="token operator">=</span> authorizationExchange<span class="token punctuation">.</span><span class="token function">getAuthorizationRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRedirectUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">String</span> codeVerifier <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>authorizationExchange<span class="token punctuation">.</span><span class="token function">getAuthorizationRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;code_verifier&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>redirectUri <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            parameters<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;redirect_uri&quot;</span><span class="token punctuation">,</span> redirectUri<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">ClientAuthenticationMethod</span><span class="token punctuation">.</span><span class="token constant">CLIENT_SECRET_BASIC</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>clientRegistration<span class="token punctuation">.</span><span class="token function">getClientAuthenticationMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            parameters<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;client_id&quot;</span><span class="token punctuation">,</span> clientRegistration<span class="token punctuation">.</span><span class="token function">getClientId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ClientAuthenticationMethod</span><span class="token punctuation">.</span><span class="token constant">CLIENT_SECRET_POST</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>clientRegistration<span class="token punctuation">.</span><span class="token function">getClientAuthenticationMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            parameters<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;client_secret&quot;</span><span class="token punctuation">,</span> clientRegistration<span class="token punctuation">.</span><span class="token function">getClientSecret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>codeVerifier <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            parameters<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;code_verifier&quot;</span><span class="token punctuation">,</span> codeVerifier<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> parameters	<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>í•´ë‹¹ í´ë˜ìŠ¤ì˜ createParameters() ë¥¼ ë³´ë©´ ê¸°ë³¸ì ìœ¼ë¡œ grant_type, code, redirect_uri ëŠ” ë“¤ì–´ê°„ë‹¤. <strong>í•˜ì§€ë§Œ client_id ëŠ” ClientAuthenticationMethod ê°€ CLIENT_SECRET_BASIC ê°€ ì•„ë‹ ë•Œë§Œ ë“¤ì–´ê°„ë‹¤.</strong> í™•ì¸ ê²°ê³¼ kakao ëŠ” CLIENT_SECRET_BASIC ì˜€ë‹¤.</p><p>ê·¸ë ‡ë‹¤ë©´ ClientAuthenticationMethod ë¥¼ ë‹¤ë¥¸ ê±¸ë¡œ (NONE ë“±) ë°”ê¿”ì£¼ë©´ ë ê¹Œ ìƒê°í–ˆì§€ë§Œ ê·¸ëŸ¬ì§€ ì•Šê¸°ë¡œ í–ˆë‹¤. ClientAuthenticationMethod ì˜ ì“°ì„ìƒˆê°€ ë‹¤ë¥¸ í•„í„°ì—ë„ ìˆë‹¤ë©´ ì˜ë„ì¹˜ ì•Šì€ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì´ë‹¤.</p><h2 id="_3-2-customtokenresponseclient" tabindex="-1"><a class="header-anchor" href="#_3-2-customtokenresponseclient"><span>3.2 CustomTokenResponseClient</span></a></h2><p>ê·¸ë˜ì„œ ë§Œë“ ê²Œ CustomTokenResponseClient ì´ë‹¤. <strong>DefaultAuthorizationCodeTokenResponseClient ë¥¼ ë³µì‚¬í•˜ê³  í•„ìš”í•œ ë¶€ë¶„ë§Œ ë³€ê²½í•˜ì˜€ë‹¤.</strong></p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomTokenResponseClient</span> <span class="token keyword">implements</span> <span class="token class-name">OAuth2AccessTokenResponseClient</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OAuth2AuthorizationCodeGrantRequest</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">INVALID_TOKEN_RESPONSE_ERROR_CODE</span> <span class="token operator">=</span> <span class="token string">&quot;invalid_token_response&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OAuth2AuthorizationCodeGrantRequest</span><span class="token punctuation">,</span> <span class="token class-name">RequestEntity</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> requestEntityConverter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OAuth2AuthorizationCodeGrantRequestEntityConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RestOperations</span> restOperations<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">CustomTokenResponseClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">RestTemplate</span> restTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FormHttpMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">OAuth2AccessTokenResponseHttpMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        restTemplate<span class="token punctuation">.</span><span class="token function">setErrorHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OAuth2ErrorResponseErrorHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>restOperations <span class="token operator">=</span> restTemplate<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">OAuth2AccessTokenResponse</span> <span class="token function">getTokenResponse</span><span class="token punctuation">(</span><span class="token class-name">OAuth2AuthorizationCodeGrantRequest</span> authorizationCodeGrantRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>authorizationCodeGrantRequest<span class="token punctuation">,</span> <span class="token string">&quot;authorizationCodeGrantRequest cannot be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">RequestEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> request <span class="token operator">=</span> <span class="token function">convert</span><span class="token punctuation">(</span>authorizationCodeGrantRequest<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>authorizationCodeGrantRequest<span class="token punctuation">.</span><span class="token function">getClientRegistration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRegistrationId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;kakao&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">addClientId</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> authorizationCodeGrantRequest<span class="token punctuation">.</span><span class="token function">getClientRegistration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClientId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OAuth2AccessTokenResponse</span><span class="token punctuation">&gt;</span></span> response <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">OAuth2AccessTokenResponse</span> tokenResponse <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>tokenResponse<span class="token punctuation">,</span> <span class="token string">&quot;The authorization server responded to this Authorization Code grant request with an empty body; as such, it cannot be materialized into an OAuth2AccessTokenResponse instance. Please check the HTTP response code in your server logs for more details.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> tokenResponse<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OAuth2AccessTokenResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token class-name">RequestEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>restOperations<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">OAuth2AccessTokenResponse</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RestClientException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">OAuth2Error</span> oauth2Error <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OAuth2Error</span><span class="token punctuation">(</span><span class="token string">&quot;invalid_token_response&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;An error occurred while attempting to retrieve the OAuth 2.0 Access Token Response: &quot;</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">OAuth2AuthorizationException</span><span class="token punctuation">(</span>oauth2Error<span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">    <span class="token doc-comment comment">/**</span>
<span class="line">     * ClientAuthenticationMethodValidatingRequestEntityConverter ë‚´ìš©</span>
<span class="line">     */</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">RequestEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">OAuth2AuthorizationCodeGrantRequest</span> grantRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">ClientRegistration</span> clientRegistration <span class="token operator">=</span> grantRequest<span class="token punctuation">.</span><span class="token function">getClientRegistration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">ClientAuthenticationMethod</span> clientAuthenticationMethod <span class="token operator">=</span> clientRegistration<span class="token punctuation">.</span><span class="token function">getClientAuthenticationMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">String</span> registrationId <span class="token operator">=</span> clientRegistration<span class="token punctuation">.</span><span class="token function">getRegistrationId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">boolean</span> supportedClientAuthenticationMethod <span class="token operator">=</span> clientAuthenticationMethod<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">ClientAuthenticationMethod</span><span class="token punctuation">.</span><span class="token constant">NONE</span><span class="token punctuation">)</span> <span class="token operator">||</span> clientAuthenticationMethod<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">ClientAuthenticationMethod</span><span class="token punctuation">.</span><span class="token constant">CLIENT_SECRET_BASIC</span><span class="token punctuation">)</span> <span class="token operator">||</span> clientAuthenticationMethod<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">ClientAuthenticationMethod</span><span class="token punctuation">.</span><span class="token constant">CLIENT_SECRET_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">isTrue</span><span class="token punctuation">(</span>supportedClientAuthenticationMethod<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;This class supports `client_secret_basic`, `client_secret_post`, and `none` by default. Client [%s] is using [%s] instead. Please use a supported client authentication method, or use `setRequestEntityConverter` to supply an instance that supports [%s].&quot;</span><span class="token punctuation">,</span> registrationId<span class="token punctuation">,</span> clientAuthenticationMethod<span class="token punctuation">,</span> clientAuthenticationMethod<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>requestEntityConverter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>grantRequest<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addClientId</span><span class="token punctuation">(</span><span class="token class-name">RequestEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> request<span class="token punctuation">,</span> <span class="token class-name">String</span> clientId<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// request ì— client_id ì¶”ê°€</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Map</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> additionalParameters <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> request<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">            additionalParameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;client_id&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonList</span><span class="token punctuation">(</span>clientId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ì½”ë“œê°€ ê¸¸ê¸´ í•œë° ì œì¼ ë°‘ì˜ <code>addClientId()</code> ë©”ì„œë“œë§Œ ë³´ë©´ ëœë‹¤. body ë¥¼ ê°€ì ¸ì™€ì„œ client_id ë¥¼ ë„£ëŠ”ë‹¤.</p><h1 id="_4-á„€á…§á†¯á„…á…©á†«" tabindex="-1"><a class="header-anchor" href="#_4-á„€á…§á†¯á„…á…©á†«"><span>4. ê²°ë¡ </span></a></h1><p>ìµœê·¼ vue ê³µë¶€ë¥¼ í•˜ë©´ì„œ ì½”ë”©ì• í”Œì˜ vue ê°•ì˜ë¥¼ ë“¤ì—ˆë‹¤. ì½”ë”©ì• í”Œì€ vue ê°€ ì‰¬ìš´ ì´ìœ ê°€ ì½”ë“œë¥¼ ì§œëŠ” ë°©ë²•ì´ ì •í˜•í™”ë˜ì–´ìˆê¸° ë•Œë¬¸ì´ë¼ê³  í–ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íŠ¹ì • ë¡œì§ì„ ë°˜ë³µ í•˜ë ¤ë©´ react ì—ì„œëŠ” map, for(), forEach ë“±ë“± ë§ì€ ì„ íƒì§€ê°€ ìˆì§€ë§Œ vue ì—ì„œëŠ” v-for ë¡œ í‰ì¹œë‹¤ê³  í–ˆë‹¤.</p><p>springSecurity ë„ ë¹„ìŠ·í•œ ë§¥ë½ì¸ë°, ê¸°ë³¸ì„¤ì •ìœ¼ë¡œ ì“°ê¸°ëŠ” ì¢‹ì§€ë§Œ ì»¤ìŠ¤í…€ì´ í•„ìš”í•˜ë©´ ì–´ë””ì„œë¶€í„° ì†ì„ ëŒ€ì•¼í•˜ëŠ”ì§€ ë§‰ë§‰í•˜ê¸°ëŠ” í•˜ë‹¤. ì´ë²ˆ ë¬¸ì œë„ ëª‡ê°€ì§€ í•´ê²°ë°©ë²•ì´ ìˆëŠ”ë°,</p><ol><li>Filter ë¥¼ êµ¬í˜„í•œë‹¤.</li><li>AuthenticationProvider ë¥¼ êµ¬í˜„í•œë‹¤.</li><li><strong>OAuth2AccessTokenResponseClient ì„ êµ¬í˜„í•œë‹¤.</strong> (ì„ íƒí•œ ë°©ì‹)</li><li>Converter ë¥¼ êµ¬í˜„í•œë‹¤. (ê°€ëŠ¥í•œì§€ëŠ” í™•ì¸ì•ˆí–ˆìŒ)</li><li>ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì§ì ‘ Controllerë¡œ êµ¬í˜„í•˜ê³  í•„í„°ë¥¼ ë¬´ì‹œí•œë‹¤.</li></ol><p>ë“±ë“± ì…€ ìˆ˜ ì—†ëŠ” ë°©ë²•ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆë‹¤. ì•ˆíƒ€ê¹ê²Œë„ ë°©ë²•ì´ ë§ìœ¼ë©´ ìƒê°ì„ ë§ì´ í•˜ê²Œ ë˜ê³ , ì¥ê³  ëì— ì•…ìˆ˜ë¥¼ ë‘ê²Œ ëœë‹¤. ê·¸ë˜ì„œ ê¸¸ê²Œ ìƒê°ì•ˆí•˜ê³  í•„ìš”í•œ ë¶€ë¶„ë§Œ ë“¤ì–´ë‚´ì„œ ê³ ì³¤ë‹¤.</p><nav class="vp-page-nav" aria-label="page navigation" data-v-63cabaa2><!----><!----></nav></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CKu5hC18.js" defer></script>
  </body>
</html>
