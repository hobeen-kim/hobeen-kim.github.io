<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>flame graph 읽는 법 | 앤디 블로그</title><meta name="description" content="flame graph 가 복잡해서 찾아본 graph 읽는 방법">
    <link rel="preload" href="/assets/style-BayvwpOp.css" as="style"><link rel="stylesheet" href="/assets/style-BayvwpOp.css">
    <link rel="modulepreload" href="/assets/app-dRGLOMXE.js"><link rel="modulepreload" href="/assets/2025-09-18-flame.html-krjuQMbZ.js">
    <link rel="prefetch" href="/assets/index.html-6UtybysX.js" as="script"><link rel="prefetch" href="/assets/index.html-BQ5ZBzky.js" as="script"><link rel="prefetch" href="/assets/index.html-DEyBCcGP.js" as="script"><link rel="prefetch" href="/assets/index.html-D80lZgXu.js" as="script"><link rel="prefetch" href="/assets/index.html-DRAFfdMY.js" as="script"><link rel="prefetch" href="/assets/2023-11-18-system.html-Bb4JH4Nl.js" as="script"><link rel="prefetch" href="/assets/2024-02-26-network.html-BvXTNh49.js" as="script"><link rel="prefetch" href="/assets/2024-04-24-cloudfinops.html-BYQeOJqc.js" as="script"><link rel="prefetch" href="/assets/2024-10-10-tensorflow.html-DaoCZBVy.js" as="script"><link rel="prefetch" href="/assets/2025-02-08-whatiswork.html-D_wDWBKX.js" as="script"><link rel="prefetch" href="/assets/2025-02-11-kafka.html-B58oltS6.js" as="script"><link rel="prefetch" href="/assets/2025-02-16-object.html-CNPqd7wN.js" as="script"><link rel="prefetch" href="/assets/2025-03-03-skilloflove.html-DLS-7rGQ.js" as="script"><link rel="prefetch" href="/assets/2025-03-08-terraform.html-D2LC3jH2.js" as="script"><link rel="prefetch" href="/assets/2025-03-09-software.html-DumDjh6j.js" as="script"><link rel="prefetch" href="/assets/2025-03-23-chosun.html-6zWqb_XX.js" as="script"><link rel="prefetch" href="/assets/2025-08-31-unittest.html-Bd7iQ8nB.js" as="script"><link rel="prefetch" href="/assets/2026-01-05-c.html-D8zqEc9w.js" as="script"><link rel="prefetch" href="/assets/2025-02-07-ze.html-oJ7dsHUT.js" as="script"><link rel="prefetch" href="/assets/2025-02-10-firstlog.html-sI46rH9E.js" as="script"><link rel="prefetch" href="/assets/2025-02-14-log.html-DwvGhnbp.js" as="script"><link rel="prefetch" href="/assets/2025-02-23-anna.html-B9ypzKtP.js" as="script"><link rel="prefetch" href="/assets/2025-03-02-bystander.html-Clnx9DSm.js" as="script"><link rel="prefetch" href="/assets/2025-04-08-k8s.html-C1SSa-PO.js" as="script"><link rel="prefetch" href="/assets/2025-04-20-log.html-c1E0wqru.js" as="script"><link rel="prefetch" href="/assets/2025-08-18-coworker.html-D_REWTfE.js" as="script"><link rel="prefetch" href="/assets/2026-01-02-design.html-BgKfYByV.js" as="script"><link rel="prefetch" href="/assets/2025-02-25-aws.html-CMbD8BeU.js" as="script"><link rel="prefetch" href="/assets/2025-03-13-aws.html-DMnZM8ND.js" as="script"><link rel="prefetch" href="/assets/2025-03-20-aws.html-CCFWn1js.js" as="script"><link rel="prefetch" href="/assets/index.html-R0-8qZXW.js" as="script"><link rel="prefetch" href="/assets/2025-08-26-culture1.html-CqGSuvob.js" as="script"><link rel="prefetch" href="/assets/2025-08-27-culturetest.html-BZ5x7OQO.js" as="script"><link rel="prefetch" href="/assets/index.html-B8KE_sks.js" as="script"><link rel="prefetch" href="/assets/2025-04-20-leteraljoin.html-B5y6yB-s.js" as="script"><link rel="prefetch" href="/assets/2025-09-30-likesearch.html-7_i2FcFr.js" as="script"><link rel="prefetch" href="/assets/index.html-D-NkXeb5.js" as="script"><link rel="prefetch" href="/assets/2023-10-20-cpucredit.html-s1mXnTss.js" as="script"><link rel="prefetch" href="/assets/2023-12-15-awslambda.html-Ct2kXgaC.js" as="script"><link rel="prefetch" href="/assets/2024-05-23-goodlog.html-D0z7Rk6w.js" as="script"><link rel="prefetch" href="/assets/2024-10-28-sg.html-he_fVXKo.js" as="script"><link rel="prefetch" href="/assets/2025-01-24-eksdnsresolve.html-QDhetJBa.js" as="script"><link rel="prefetch" href="/assets/2025-03-15-filesystem.html-D5WlTVfm.js" as="script"><link rel="prefetch" href="/assets/2025-05-04-awsregion.html-CXxd2gu3.js" as="script"><link rel="prefetch" href="/assets/2025-09-03-kuberesource.html-DrbbhzVq.js" as="script"><link rel="prefetch" href="/assets/2025-09-05-podeviction.html-CkAQ2wT5.js" as="script"><link rel="prefetch" href="/assets/2025-09-15-autoscaling.html-iTZkDwGr.js" as="script"><link rel="prefetch" href="/assets/2025-09-22-rollingupdate.html-DLAOE8ry.js" as="script"><link rel="prefetch" href="/assets/2025-09-29-loadtest.html-agYZB_14.js" as="script"><link rel="prefetch" href="/assets/2025-11-17-kms.html-DOgaLrxu.js" as="script"><link rel="prefetch" href="/assets/index.html-BdmCl6Gy.js" as="script"><link rel="prefetch" href="/assets/2025-09-17-hashmap.html-DIbH-cVF.js" as="script"><link rel="prefetch" href="/assets/2025-09-23-referencevalue.html-SwOxUumN.js" as="script"><link rel="prefetch" href="/assets/2025-10-04-stringimmutable.html-D7PDlKdA.js" as="script"><link rel="prefetch" href="/assets/2025-10-05-immutableclass.html-xHLzjSib.js" as="script"><link rel="prefetch" href="/assets/2025-10-05-singleton.html-CE6FHQ5n.js" as="script"><link rel="prefetch" href="/assets/index.html-BNfp-Hxy.js" as="script"><link rel="prefetch" href="/assets/2025-01-18-kafkadocker.html-D7_CCPWb.js" as="script"><link rel="prefetch" href="/assets/2025-10-25-kafkaaggregate.html-DnL9joU8.js" as="script"><link rel="prefetch" href="/assets/2025-12-09-kafkadesignpattern.html-CLCl0va6.js" as="script"><link rel="prefetch" href="/assets/index.html-BZa1CjSt.js" as="script"><link rel="prefetch" href="/assets/2023-04-12-validation.html-AV03Lt5g.js" as="script"><link rel="prefetch" href="/assets/2023-04-18-rtr.html-DJTtfP1J.js" as="script"><link rel="prefetch" href="/assets/2023-04-25-mdc.html-Bab7vLeA.js" as="script"><link rel="prefetch" href="/assets/2023-05-10-SpringRestDocs1.html-Dx2y4C7d.js" as="script"><link rel="prefetch" href="/assets/2023-05-13-SpringRestDocs2.html-BYCLgBYK.js" as="script"><link rel="prefetch" href="/assets/2023-05-14-SpringRestDocs3.html-D4yST1Yg.js" as="script"><link rel="prefetch" href="/assets/2025-02-13-security.html-CG_WrRbB.js" as="script"><link rel="prefetch" href="/assets/2025-06-25-alarm.html-BChfDpwr.js" as="script"><link rel="prefetch" href="/assets/2025-07-20-ssewebsocket.html--u5OTGAn.js" as="script"><link rel="prefetch" href="/assets/2025-08-05-test1.html-CR2VpOc-.js" as="script"><link rel="prefetch" href="/assets/2025-08-20-test2.html-0BhGxnKK.js" as="script"><link rel="prefetch" href="/assets/2025-08-28-jsonproperty.html-p-4VWg9_.js" as="script"><link rel="prefetch" href="/assets/2025-09-08-sonarqube.html-DC3yG3mz.js" as="script"><link rel="prefetch" href="/assets/2025-10-22-eventhandler.html-5Lr6rGQK.js" as="script"><link rel="prefetch" href="/assets/index.html-CTvBoDcq.js" as="script"><link rel="prefetch" href="/assets/2025-01-01-list.html-kUt5jupm.js" as="script"><link rel="prefetch" href="/assets/2025-06-27-iot.html-BmPnaC9q.js" as="script"><link rel="prefetch" href="/assets/2025-07-20-ssewebsocket.html-C-xohydX.js" as="script"><link rel="prefetch" href="/assets/2025-08-13-mqtt.html-BiwlgN-t.js" as="script"><link rel="prefetch" href="/assets/2025-08-29-oidc.html-CRStSlpP.js" as="script"><link rel="prefetch" href="/assets/2025-09-04-smtp.html-CjIAAUOS.js" as="script"><link rel="prefetch" href="/assets/2025-09-16-cscd.html-DIfvVbv6.js" as="script"><link rel="prefetch" href="/assets/2025-10-01-keycloak.html-Dvv4vUI0.js" as="script"><link rel="prefetch" href="/assets/index.html-DsR8_D4f.js" as="script"><link rel="prefetch" href="/assets/404.html-DUa61yu6.js" as="script"><link rel="prefetch" href="/assets/html2pdf-C86WUIwM.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-DxuoSNA6.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="vp-site-name" aria-hidden="true">앤디 블로그</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="글"><span class="title">글</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="글"><span class="title">글</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/" aria-label="모두"><!--[--><!--[--><!--]--><!--]-->모두<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/culture/" aria-label="개발 문화"><!--[--><!--[--><!--]--><!--]-->개발 문화<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/tech/" aria-label="기술"><!--[--><!--[--><!--]--><!--]-->기술<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/java/" aria-label="자바"><!--[--><!--[--><!--]--><!--]-->자바<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/spring/" aria-label="스프링"><!--[--><!--[--><!--]--><!--]-->스프링<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/infra/" aria-label="인프라"><!--[--><!--[--><!--]--><!--]-->인프라<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/kafka/" aria-label="카프카"><!--[--><!--[--><!--]--><!--]-->카프카<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/database/" aria-label="데이터베이스"><!--[--><!--[--><!--]--><!--]-->데이터베이스<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/conference/" aria-label="컨퍼런스"><!--[--><!--[--><!--]--><!--]-->컨퍼런스<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/books/" aria-label="책"><!--[--><!--[--><!--]--><!--]-->책<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/logs/" aria-label="짧은 글"><!--[--><!--[--><!--]--><!--]-->짧은 글<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/resume/" aria-label="이력서"><!--[--><!--[--><!--]--><!--]-->이력서<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="글"><span class="title">글</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="글"><span class="title">글</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/" aria-label="모두"><!--[--><!--[--><!--]--><!--]-->모두<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/culture/" aria-label="개발 문화"><!--[--><!--[--><!--]--><!--]-->개발 문화<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/tech/" aria-label="기술"><!--[--><!--[--><!--]--><!--]-->기술<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/java/" aria-label="자바"><!--[--><!--[--><!--]--><!--]-->자바<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/spring/" aria-label="스프링"><!--[--><!--[--><!--]--><!--]-->스프링<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/infra/" aria-label="인프라"><!--[--><!--[--><!--]--><!--]-->인프라<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/kafka/" aria-label="카프카"><!--[--><!--[--><!--]--><!--]-->카프카<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/database/" aria-label="데이터베이스"><!--[--><!--[--><!--]--><!--]-->데이터베이스<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/posts/conference/" aria-label="컨퍼런스"><!--[--><!--[--><!--]--><!--]-->컨퍼런스<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/books/" aria-label="책"><!--[--><!--[--><!--]--><!--]-->책<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/logs/" aria-label="짧은 글"><!--[--><!--[--><!--]--><!--]-->짧은 글<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/resume/" aria-label="이력서"><!--[--><!--[--><!--]--><!--]-->이력서<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">flame graph 읽는 법 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#_1-flame-graph-읽는-방법" aria-label="1. Flame Graph 읽는 방법"><!--[--><!--[--><!--]--><!--]-->1. Flame Graph 읽는 방법<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#_2-싱글-콜스택-구조" aria-label="2. 싱글 콜스택 구조"><!--[--><!--[--><!--]--><!--]-->2. 싱글 콜스택 구조<!--[--><!--[--><!--]--><!--]--></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#_2-1-구조" aria-label="2.1 구조"><!--[--><!--[--><!--]--><!--]-->2.1 구조<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#_2-2-상세" aria-label="2.2 상세"><!--[--><!--[--><!--]--><!--]-->2.2 상세<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#_3-여러-콜스택의-통합" aria-label="3. 여러 콜스택의 통합"><!--[--><!--[--><!--]--><!--]-->3. 여러 콜스택의 통합<!--[--><!--[--><!--]--><!--]--></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#_3-1-sampling" aria-label="3.1 Sampling"><!--[--><!--[--><!--]--><!--]-->3.1 Sampling<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#_3-2-sorting" aria-label="3.2 Sorting"><!--[--><!--[--><!--]--><!--]-->3.2 Sorting<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#_3-3-merging-grouping" aria-label="3.3 Merging (Grouping)"><!--[--><!--[--><!--]--><!--]-->3.3 Merging (Grouping)<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#_4-flame-graph-활용" aria-label="4. Flame graph 활용"><!--[--><!--[--><!--]--><!--]-->4. Flame graph 활용<!--[--><!--[--><!--]--><!--]--></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#_4-1-성능-이슈-찾기" aria-label="4.1 성능 이슈 찾기"><!--[--><!--[--><!--]--><!--]-->4.1 성능 이슈 찾기<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#_4-2-코드-개선" aria-label="4.2 코드 개선"><!--[--><!--[--><!--]--><!--]-->4.2 코드 개선<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#_4-3-개선-측정" aria-label="4.3 개선 측정"><!--[--><!--[--><!--]--><!--]-->4.3 개선 측정<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#_4-4-반복과-정제" aria-label="4.4 반복과 정제"><!--[--><!--[--><!--]--><!--]-->4.4 반복과 정제<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#ref" aria-label="Ref."><!--[--><!--[--><!--]--><!--]-->Ref.<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><header class="page-header" data-v-84f05ea1><h1 class="title" data-v-84f05ea1>flame graph 읽는 법</h1><div class="meta" data-v-84f05ea1><time data-v-84f05ea1>2025년 9월 18일</time></div></header><nav class="table-of-contents"><ul><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_1-flame-graph-읽는-방법" class="router-link-active router-link-exact-active">1. Flame Graph 읽는 방법</a></li><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_2-싱글-콜스택-구조" class="router-link-active router-link-exact-active">2. 싱글 콜스택 구조</a><ul><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_2-1-구조" class="router-link-active router-link-exact-active">2.1 구조</a></li><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_2-2-상세" class="router-link-active router-link-exact-active">2.2 상세</a></li></ul></li><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_3-여러-콜스택의-통합" class="router-link-active router-link-exact-active">3. 여러 콜스택의 통합</a><ul><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_3-1-sampling" class="router-link-active router-link-exact-active">3.1 Sampling</a></li><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_3-2-sorting" class="router-link-active router-link-exact-active">3.2 Sorting</a></li><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_3-3-merging-grouping" class="router-link-active router-link-exact-active">3.3 Merging (Grouping)</a></li></ul></li><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_4-flame-graph-활용" class="router-link-active router-link-exact-active">4. Flame graph 활용</a><ul><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_4-1-성능-이슈-찾기" class="router-link-active router-link-exact-active">4.1 성능 이슈 찾기</a></li><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_4-2-코드-개선" class="router-link-active router-link-exact-active">4.2 코드 개선</a></li><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_4-3-개선-측정" class="router-link-active router-link-exact-active">4.3 개선 측정</a></li><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#_4-4-반복과-정제" class="router-link-active router-link-exact-active">4.4 반복과 정제</a></li></ul></li><li><a aria-current="page" href="/posts/tech/2025-09-18-flame.html#ref" class="router-link-active router-link-exact-active">Ref.</a></li></ul></nav><p>Flame Graph 는 소프트웨어 performance 를 분석하는 데 필수적인 도구다. 병목 구간과 코드 최적화를 위한 시각화 도구를 제공한다. Flame Graph 를 뒤집어놓은 게 Icicle 인데 콜스택이라는 의미에 맞게 위에서 아래로 구성되어있다.</p><p>아래는 그라파나에서 설정한 pyroscope 의 Flame Graph 이다. (실제로는 icicle 인 듯하다.)</p><p><img src="/images/2025-09-18-flame/image-20250918142334423.png" alt="image-20250918142334423"></p><h1 id="_1-flame-graph-읽는-방법" tabindex="-1"><a class="header-anchor" href="#_1-flame-graph-읽는-방법"><span>1. Flame Graph 읽는 방법</span></a></h1><p>가장 명심해야 할 건 &quot;<strong>색은 아무 의미 없으며</strong>&quot;, &quot;<strong>x 축은 시간 순이 아니다</strong>&quot; 다. 이를 염두에 두고 설명한다.</p><p><img src="/images/2025-09-18-flame/thumbnail.png" alt="image-20250918142557305"></p><ol><li>각각의 사각형은 스택의 함수 호출을 의미한다. 그리고 그 사각형의 너비는 함수의 상대적인 리소스 사용량을 의미하는데, 하위 함수의 사용량도 함께 포함한다.</li><li>y 축은 스택의 깊이다. 가장 위쪽의 사각형은 실행 중인 leaf 함수로 자원이 소비되는 지점이다. 그리고 그 하위의 스택들은 호출 경로를 의미한다.</li><li>x 축은 시간의 흐름이 아니라 샘플링된 데이터를 좌우로 펼쳐놓은 것이다. 같은 스택들을 합친다음 알파벳 순서로 정렬된다.</li><li>사각형의 너비는 리소스의 총 사용량을 나타낸다. 넓은 사각형의 함수는 좁은 사각형보다 리소스를 더 많이 소모했을 것이다.</li></ol><blockquote><p>색은 특별한 의미를 가지고 있지 않다. 함수별로 똑같은 색을 가질 수는 있지만 랜덤한 패턴으로 색이 선택된다. (flame 은 주로 붉은 계열)</p></blockquote><h1 id="_2-싱글-콜스택-구조" tabindex="-1"><a class="header-anchor" href="#_2-싱글-콜스택-구조"><span>2. 싱글 콜스택 구조</span></a></h1><p>Flame graph 는 프로그램의 콜스택을 보여준다. 그게 정확히 어떤 의미일까?</p><h2 id="_2-1-구조" tabindex="-1"><a class="header-anchor" href="#_2-1-구조"><span>2.1 구조</span></a></h2><p>그래프는 가로로 정렬된 직사각형들로 구성된 콜스택이다. 각 직사각형은 하나의 함수이고 그 너비는 그 함수가 소비한 시간(하위 함수를 포함하여)을 의미한다. 직사각형들은 다른 직사각형 위에 계속 쌓인다. 따라서 부모 함수가 가장 아래에 위치하고 하위 함수가 위에 계속 쌓이는 형식이다. 이 계층적 구조와 관계는 수직적인 정렬로 이해하기 쉽게 구성된다. 중요한 점은 다음과 같다.</p><ul><li>각 직사각형의 너비는 함수의 리소스 소모량을 나타낸다.</li><li>직사각형의 높이는 아무런 의미가 없다. 수직적인 정렬은 콜스택의 계층적 구조를 나타내기 위함이다.</li></ul><h2 id="_2-2-상세" tabindex="-1"><a class="header-anchor" href="#_2-2-상세"><span>2.2 상세</span></a></h2><p>하나의 콜스택으로 어떻게 그래프가 그려지는지 확인해보자. 다음 함수는 <code>a</code> 함수가 <code>b</code> 함수를 부르고, <code>b</code> 함수가 무한 루프를 도는 <code>c</code> 함수를 호출한다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>예를 들어 위 함수를 50ms 동안 프로파일링했다면 아래와 같이 나타난다.</p><p><img src="/images/2025-09-18-flame/image-20250919103504996.png" alt="image-20250919103504996"></p><p>이 예제에서 <code>c</code> 함수가 시간의 대부분을 사용하지만 모든 직사각형이 같은 너비를 가지고 있다. 그 이유는 직사각형의 너비가 그 함수와 하위 함수까지 포함하기때문이다.</p><p>만약 <code>c</code> 함수를 더 많이 호출한다면 어떻게 될까?</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1_000_000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>큰 변화가 있어보이지는 않는다. 왜냐하면 콜스택은 <code>merge</code> 되기 때문이다. 따라서 <code>c</code> 함수는 <code>b</code> 함수 위에서 3개로 나눠지는 게 아니라 하나로 합쳐져서 보인다. 즉 <strong>함수가 같은 레벨에서 몇 번이나 실행되었느냐는 flame graph 에서 보여지지 않는다.</strong></p><p><img src="/images/2025-09-18-flame/image-20250919103504996.png" alt="image-20250919103504996"></p><p>여기서 이제 <code>b</code> 함수가 <code>d</code>, <code>e</code> 함수를 추가로 호출해보자. 순서는 <code>d</code> -&gt; <code>e</code> -&gt; <code>c</code> 순서로 호출한다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1_000_000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1_000_000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1_000_000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>그러면 아래와 같이 나타난다.</p><p><img src="/images/2025-09-18-flame/image-20250919104717340.png" alt="image-20250919104717340"></p><p>해당 콜스택에서 눈여겨볼 점은 <code>b</code> 의 하위로 <code>d</code> -&gt; <code>e</code> -&gt; <code>c</code> 순서로 호출되었는데 flame graph 에서는 알파벳 순서로 정렬되어있다. <strong>콜스택은 호출 순서와 전혀 관련이 없다는 뜻이다.</strong> 또한 x 축은 시간의 흐름을 나타내지 않는 것도 기억해야 한다.</p><p>비슷하게 이번에는 <code>a</code> -&gt; <code>b</code>, <code>c</code> -&gt; (b,c 각각) <code>d</code>,<code>e</code>,<code>f</code> 순으로 호출한다고 해보자.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1_000_000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1_000_000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1_000_000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>위 main 함수를 호출한 콜스택은 아래와 같이 된다. 여기서 확인할 점은 <code>d</code>, <code>e</code>, <code>f</code> 함수가 같은 깊이에서 두번씩 호출되더라도 같은 부모 함수가 아니라면 merge 되지 않는다는 것이다.</p><p><img src="/images/2025-09-18-flame/image-20250919131244957.png" alt="image-20250919131244957"></p><h1 id="_3-여러-콜스택의-통합" tabindex="-1"><a class="header-anchor" href="#_3-여러-콜스택의-통합"><span>3. 여러 콜스택의 통합</span></a></h1><p>프로그램이 실행되는 동안 수많은 콜스택이 생성된다. 1초 동안 프로그램은 수천 개의 콜스택을 가질 수 있는데 이는 현실적으로 모두 수집하기가 쉽지 않다. 따라서 일정 간격으로 샘플링을 하고 스택을 통합하면서 이를 해결할 수 있다.</p><p>콜스택은 다음 3단계로 수집되고 통합된다.</p><h2 id="_3-1-sampling" tabindex="-1"><a class="header-anchor" href="#_3-1-sampling"><span>3.1 Sampling</span></a></h2><p>샘플링은 성능 분석을 위해 통계적으로 중요하고 충분한 데이터를 제공한다. 샘플링은 모든 이벤트에 대한 수집 없이 프로그램 리소스 소모를 보여준다. 콜스택을 지속적으로 캡처하면서 프로그램 실행의 트랜드와 패턴에 대한 <strong>스냅샷</strong>을 얻는 것이다.</p><blockquote><p>이러한 접근은 데이터 분석을 위한 성능 오버헤드를 최소화하면서 더 효율적이고 관리가 편하게 만든다. 물론 모든 이벤트를 기록하는 게 더 포괄적인 관점을 제공하겠지만 너무 큰 오버헤드와 감당할 수 없는 데이터량에 압도될 수 있다. 따라서 샘플링은 데이터를 실용적으로 수집하면서도 신뢰할 수 있고 효율적인 성능 분석을 가능케 한다.</p></blockquote><p>예를 들어 50ms 의 간격으로 아래와 같은 샘플링 데이터를 얻었다고 하자. 50ms 간격으로 하나씩(여기선 왼쪽부터) 스냅샷을 떠 하나의 수직적인 콜스택을 얻는다.</p><p><img src="/images/2025-09-18-flame/image-20250919132358833.png" alt="image-20250919132358833"></p><h2 id="_3-2-sorting" tabindex="-1"><a class="header-anchor" href="#_3-2-sorting"><span>3.2 Sorting</span></a></h2><p>이제 샘플링된 콜스택을 주어진 시간 범위 내에서 알파벳 순으로 정렬한다. (이때 샘플의 순서는 보장되지 않는다.)</p><p><img src="/images/2025-09-18-flame/image-20250919132641975.png" alt="image-20250919132641975"></p><h2 id="_3-3-merging-grouping" tabindex="-1"><a class="header-anchor" href="#_3-3-merging-grouping"><span>3.3 Merging (Grouping)</span></a></h2><p>마지막으로 같은 콜스택을 모두 더한다. 앞서 싱글 스택에서 <code>c</code> 함수가 같은 레벨이고 같은 부모일 때 merge 되는 것을 확인했다. 그것과 같은 과정이다.</p><p><img src="/images/2025-09-18-flame/image-20250919132822033.png" alt="image-20250919132822033"></p><p>이 과정을 통해 flame graph 가 그려지고, 이를 통해 병목 현상을 식별하고 코드를 최적화할 수 있게 된다.</p><h1 id="_4-flame-graph-활용" tabindex="-1"><a class="header-anchor" href="#_4-flame-graph-활용"><span>4. Flame graph 활용</span></a></h1><p>성능 최적화는 모든 소프트웨어에 중요한 문제이며, 유저 경험과 시스템 리소스에 큰 영향을 미친다. 따라서 성능 이슈의 원인을 확인하고 매우 중요하고, 특히 큰 코드베이스와 복잡한 콜스택에서 더 중요해준다. Flame graph 는 다음과 같을 때 유용하다.</p><ol><li><strong>복잡한 데이터 시각화</strong> : Flame graph 는 콜스택 데이터를 그래프로 보여줘서 서로 다른 함수 간의 관계나 리소스 소모를 더 잘 표현하고 이해하기 쉽게 만들어준다.</li><li><strong>병목구간 식별</strong> : 콜스택 데이터를 시각화해서 개발자들이 CPU 소모량이나 메모리 양이 큰 병목구간을 식별하게 해준다.</li><li><strong>profile 비교</strong> : flame graph 는 다른 프로필과 비교해서 코드베이스의 수정이 성능 상으로 어떤 변화를 가져오는지 알기 쉽게 해준다.</li></ol><p><img src="/images/2025-09-18-flame/image-20250919133422527.png" alt="image-20250919133422527"></p><h2 id="_4-1-성능-이슈-찾기" tabindex="-1"><a class="header-anchor" href="#_4-1-성능-이슈-찾기"><span>4.1 성능 이슈 찾기</span></a></h2><p><strong>너비가 긴 콜스택 찾기</strong></p><p>많은 양의 리소스를 소모하는 함수를 찾으려면 우선 직사각형의 길이가 긴 함수를 찾는다. 그 함수가 바로 전체 실행 시간의 큰 부분을 차지한다. 그리고 이런 함수들을 최적화의 후보로 잡아야 한다.</p><p><img src="/images/2025-09-18-flame/image-20250919133643773.png" alt="image-20250919133643773"></p><p><strong>콜스택 검사</strong></p><p>다른 함수들 간의 관계를 이해하기 위해 호출 스택 계층 구조를 확인해야 한다. 이를 통해 성능 문제가 단일 함수에서 비롯된 것인지, 아니면 여러 함수의 조합에서 발생한 것인지 파악할 수 있다. 또한 호출 스택을 이해하면 리팩터링이나 불필요한 호출 제거와 같은 최적화 기회를 발견할 수도 있다.</p><p><strong>tall 스택 확인</strong></p><p>호출의 깊이가 긴 tall 스택은 복잡하고 비효율적인 코드일 수 있다.</p><p><img src="/images/2025-09-18-flame/image-20250919133954007.png" alt="image-20250919133954007"></p><p><strong>반복 패턴 확인</strong></p><p>그래프에서 반복되는 패턴은 불필요하거나 반복적인 코드일 수 있고, 개선의 대상이 될 수 이싿.</p><h2 id="_4-2-코드-개선" tabindex="-1"><a class="header-anchor" href="#_4-2-코드-개선"><span>4.2 코드 개선</span></a></h2><p>만약 문제가 되는 함수를 찾고 콜스택을 분석했다면 코드 개선을 시작해야 한다.</p><ol><li><strong>알고리즘 최적화</strong></li><li><strong>성능이 매우 중요한 코드 경로의 함수 호출을 최소화</strong></li><li><strong>코드 병렬</strong> : 성능 병목 현상이 CPU 연산에 의해 발생한다면, 코드를 병렬화하여 여러 프로세서 코어를 활용하는 것을 고려해야 한다.</li><li><strong>메모리 사용 줄이기</strong> : 메모리 할당과 해제를 최적화하고, 메모리 단편화를 최소화해야 한다.</li></ol><h2 id="_4-3-개선-측정" tabindex="-1"><a class="header-anchor" href="#_4-3-개선-측정"><span>4.3 개선 측정</span></a></h2><p>개선 이후에는 새로운 프로파일링 데이터로 flame graph 를 확인한다. 이전 그래프와 새로운 그래프를 확인하면서 개선 사항이 성능 상으로 어떤 변화를 보여주는지 측정한다.</p><p>만약 개선이 성공적이라면 문제가 되는 함수의 너비가 줄어드는 것을 볼 수 있을 것이다.</p><h2 id="_4-4-반복과-정제" tabindex="-1"><a class="header-anchor" href="#_4-4-반복과-정제"><span>4.4 반복과 정제</span></a></h2><p>성능 개선은 반복적인 프로세스다. 지속적으로 분석하고 그래프를 업데이트하면서 새로운 병목 구간을 찾고 관련된 코드를 업데이트해야 한다. 그러면서 목표로 하는 성능까지 지속적으로 개선해야 한다.</p><h1 id="ref" tabindex="-1"><a class="header-anchor" href="#ref"><span>Ref.</span></a></h1><ul><li><a href="https://www.polarsignals.com/blog/posts/2023/03/28/how-to-read-icicle-and-flame-graphs" target="_blank" rel="noopener noreferrer">Ice and Fire: How to read icicle and flame graphs</a></li></ul><nav class="vp-page-nav" aria-label="page navigation" data-v-63cabaa2><!----><!----></nav></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-dRGLOMXE.js" defer></script>
  </body>
</html>
